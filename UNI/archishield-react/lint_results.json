
> archishield-react@0.0.0 lint
> eslint . --format json

[{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/scripts/filter_buildings.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/App.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'clearResults' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"clearResults"},"fix":{"range":[643,666],"text":""},"desc":"Remove unused variable 'clearResults'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Vienna Spot-Audit - Main Application\n */\nimport { useState, useCallback, useMemo } from 'react';\nimport { Header } from './components/Layout/Header';\nimport { Map } from './components/Map';\nimport { TelemetryPanel } from './components/TelemetryPanel';\nimport { AuditTimeline } from './components/AuditTimeline';\nimport { Onboarding } from './components/Onboarding';\nimport ChatPanel from './components/ChatPanel';\nimport { useSpotAudit } from './hooks/useSpotAudit';\nimport './App.css';\n\nfunction App() {\n    const { \n        results, \n        isLoading, \n        currentPhase, \n        phaseIndex, \n        phases,\n        runSpotAudit, \n        clearResults,\n        buildingConfig,\n        setMaterial,\n        updateBuildingConfig\n    } = useSpotAudit();\n    \n    const [selectedLocation, setSelectedLocation] = useState(null);\n\n    const handleLocationSelect = useCallback((lat, lng) => {\n        setSelectedLocation({ lat, lng });\n        // Automatically run audit when location is clicked\n        runSpotAudit(lat, lng);\n    }, [runSpotAudit]);\n\n    const handleBuildingSelect = useCallback((building) => {\n        setSelectedLocation({ lat: building.lat, lng: building.lng });\n        // Run audit with building parameters\n        runSpotAudit(building.lat, building.lng, {\n            height: building.height,\n            floors: building.levels\n        });\n    }, [runSpotAudit]);\n    \n    // Calculate envelope data for 3D visualization\n    // Uses buildingConfig values so it updates when sliders change\n    const envelopeData = useMemo(() => {\n        if (!results?.success || !selectedLocation) return null;\n        \n        const contextualLimit = results.audits?.zoning?.contextualLimit || 21;\n        const currentHeight = buildingConfig?.height || results.building?.height || 20;\n        const currentFootprint = buildingConfig?.footprint || 200;\n        const currentRotation = buildingConfig?.rotation || 0;\n        const isOverLimit = currentHeight > contextualLimit;\n        \n        // Calculate offset based on footprint (sqrt for reasonable proportions)\n        const baseOffset = 0.0003; // ~30m\n        const footprintScale = Math.sqrt(currentFootprint / 200);\n        const offset = baseOffset * footprintScale;\n        \n        return {\n            lat: selectedLocation.lat,\n            lng: selectedLocation.lng,\n            height: currentHeight,\n            contextualLimit,\n            isOverLimit,\n            offset,\n            rotation: currentRotation\n        };\n    }, [results, selectedLocation, buildingConfig]);\n\n    return (\n        <div className=\"app\">\n            <Onboarding />\n            <Header \n                district={results?.district}\n                coords={selectedLocation}\n            />\n            \n            <main className=\"main-content\">\n                {/* Map Panel - 60% */}\n                <div className=\"map-panel\">\n                    <Map \n                        onLocationSelect={handleLocationSelect}\n                        onBuildingSelect={handleBuildingSelect}\n                        envelopeData={envelopeData}\n                    />\n                </div>\n\n                {/* Telemetry Panel - 40% */}\n                <div className=\"telemetry-wrapper\">\n                    <TelemetryPanel \n                        results={results} \n                        loading={isLoading}\n                        phase={currentPhase?.name}\n                        buildingConfig={buildingConfig}\n                        onMaterialChange={setMaterial}\n                        onConfigChange={updateBuildingConfig}\n                    />\n                </div>\n            </main>\n\n            {/* Audit Timeline */}\n            <footer className=\"timeline-footer\">\n                <AuditTimeline \n                    phases={phases}\n                    currentPhaseIndex={phaseIndex}\n                    isLoading={isLoading}\n                />\n            </footer>\n\n            {/* AI Chat Assistant */}\n            <ChatPanel \n                auditContext={results?.success ? {\n                    lat: selectedLocation?.lat,\n                    lng: selectedLocation?.lng,\n                    district: results.district,\n                    feasibility: results.feasibility,\n                    constraints: results.constraints?.map(c => c.description),\n                    mandates: results.mandates?.map(m => m.requirement)\n                } : null}\n                auditResults={results?.success ? results : null}\n                onApplyFix={updateBuildingConfig}\n            />\n        </div>\n    );\n}\n\nexport default App;\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/AuditForm/AuditForm.jsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: This value cannot be modified\n\nModifying a variable defined outside a component or hook is not allowed. Consider using an effect.\n\n  37 |\n  38 |     // Expose updateLocation for map clicks\n> 39 |     if (window) window.updateBuildingLocation = updateLocation;\n     |                 ^^^^^^ value cannot be modified\n  40 |\n  41 |     return (\n  42 |         <form className=\"audit-form\" onSubmit={handleSubmit}>","line":39,"column":17,"nodeType":null,"endLine":39,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// AuditForm Component - Simple mode form for building input\nimport { useState } from 'react';\nimport './AuditForm.css';\n\nexport function AuditForm({ onSubmit, isLoading }) {\n    const [building, setBuilding] = useState({\n        name: 'My Building',\n        height: 30,\n        floors: 10,\n        footprint_area: 1500,\n        lot_area: 3000,\n        ground_floor_material: 'reinforced_concrete',\n        structural_system: 'dual_system',\n        foundation_depth: 5,\n        window_to_wall_ratio: 0.35,\n        latitude: 48.2082,\n        longitude: 16.3738,\n        material_density: 2400,\n        thermal_mass: 850,\n        insulation_r_value: 6.0,\n        energy_autonomy_level: 60,\n        occupancy: 200\n    });\n\n    const handleChange = (field, value) => {\n        setBuilding(prev => ({ ...prev, [field]: value }));\n    };\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        onSubmit(building);\n    };\n\n    const updateLocation = (lat, lng) => {\n        setBuilding(prev => ({ ...prev, latitude: lat, longitude: lng }));\n    };\n\n    // Expose updateLocation for map clicks\n    if (window) window.updateBuildingLocation = updateLocation;\n\n    return (\n        <form className=\"audit-form\" onSubmit={handleSubmit}>\n            <div className=\"form-section\">\n                <h3>üìã Building Details</h3>\n                \n                <div className=\"form-grid\">\n                    <div className=\"form-field full-width\">\n                        <label>Building Name</label>\n                        <input \n                            type=\"text\" \n                            value={building.name}\n                            onChange={(e) => handleChange('name', e.target.value)}\n                        />\n                    </div>\n\n                    <div className=\"form-field\">\n                        <label>Height (m)</label>\n                        <input \n                            type=\"number\" \n                            value={building.height}\n                            onChange={(e) => handleChange('height', parseInt(e.target.value))}\n                        />\n                    </div>\n\n                    <div className=\"form-field\">\n                        <label>Floors</label>\n                        <input \n                            type=\"number\" \n                            value={building.floors}\n                            onChange={(e) => handleChange('floors', parseInt(e.target.value))}\n                        />\n                    </div>\n\n                    <div className=\"form-field\">\n                        <label>Footprint (m¬≤)</label>\n                        <input \n                            type=\"number\" \n                            value={building.footprint_area}\n                            onChange={(e) => handleChange('footprint_area', parseInt(e.target.value))}\n                        />\n                    </div>\n\n                    <div className=\"form-field\">\n                        <label>Lot Area (m¬≤)</label>\n                        <input \n                            type=\"number\" \n                            value={building.lot_area}\n                            onChange={(e) => handleChange('lot_area', parseInt(e.target.value))}\n                        />\n                    </div>\n\n                    <div className=\"form-field\">\n                        <label>Material</label>\n                        <select \n                            value={building.ground_floor_material}\n                            onChange={(e) => handleChange('ground_floor_material', e.target.value)}\n                        >\n                            <option value=\"reinforced_concrete\">Reinforced Concrete</option>\n                            <option value=\"steel\">Steel Frame</option>\n                            <option value=\"timber\">Timber / CLT</option>\n                            <option value=\"masonry\">Masonry / Brick</option>\n                            <option value=\"green_facade\">Green Facade</option>\n                        </select>\n                    </div>\n\n                    <div className=\"form-field\">\n                        <label>Structure</label>\n                        <select \n                            value={building.structural_system}\n                            onChange={(e) => handleChange('structural_system', e.target.value)}\n                        >\n                            <option value=\"dual_system\">Dual System (Best)</option>\n                            <option value=\"moment_frame\">Moment Frame</option>\n                            <option value=\"shear_wall\">Shear Wall</option>\n                            <option value=\"bearing_wall\">Bearing Wall</option>\n                        </select>\n                    </div>\n\n                    <div className=\"form-field\">\n                        <label>Foundation (m)</label>\n                        <input \n                            type=\"number\" \n                            value={building.foundation_depth}\n                            step=\"0.5\"\n                            onChange={(e) => handleChange('foundation_depth', parseFloat(e.target.value))}\n                        />\n                    </div>\n\n                    <div className=\"form-field\">\n                        <label>WWR (%)</label>\n                        <input \n                            type=\"number\" \n                            value={building.window_to_wall_ratio * 100}\n                            min=\"0\" max=\"100\"\n                            onChange={(e) => handleChange('window_to_wall_ratio', parseInt(e.target.value) / 100)}\n                        />\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"form-section location-section\">\n                <h3>üìç Location</h3>\n                <p className=\"location-hint\">Click on the map to set building location</p>\n                <div className=\"location-display\">\n                    <span>Lat: {building.latitude.toFixed(4)}</span>\n                    <span>Lng: {building.longitude.toFixed(4)}</span>\n                </div>\n            </div>\n\n            <button \n                type=\"submit\" \n                className=\"submit-btn\"\n                disabled={isLoading}\n            >\n                {isLoading ? '‚è≥ Running Audit...' : 'üöÄ Run Audit'}\n            </button>\n        </form>\n    );\n}\n\nexport default AuditForm;\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/AuditForm/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/AuditResults/AuditResults.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":11,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[377,378],"text":""},"desc":"Remove unused variable '_'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":23,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[788,789],"text":""},"desc":"Remove unused variable '_'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// AuditResults Component - Displays audit results with traffic light icons\nimport './AuditResults.css';\n\nexport function AuditResults({ results }) {\n    if (!results || !results.success) return null;\n\n    const { auditResults, globalScore, status } = results;\n    \n    // Count passed/failed\n    const audits = Object.entries(auditResults);\n    const passed = audits.filter(([_, r]) => r.passed).length;\n    const failed = audits.length - passed;\n\n    // Determine summary\n    const getSummaryIcon = () => {\n        if (failed === 0) return 'üü¢';\n        if (failed <= 2) return 'üü°';\n        return 'üî¥';\n    };\n\n    const getSummaryText = () => {\n        if (failed === 0) return `All ${passed} checks passed! Ready for permit submission.`;\n        const failedNames = audits.filter(([_, r]) => !r.passed).map(([k]) => k).join(', ');\n        return `${passed} of ${audits.length} passed. Issues: ${failedNames}`;\n    };\n\n    return (\n        <div className=\"audit-results\">\n            {/* Summary Banner */}\n            <div className={`summary-banner ${failed === 0 ? 'success' : failed <= 2 ? 'warning' : 'danger'}`}>\n                <span className=\"summary-icon\">{getSummaryIcon()}</span>\n                <div className=\"summary-content\">\n                    <div className=\"summary-title\">{status}</div>\n                    <div className=\"summary-text\">{getSummaryText()}</div>\n                </div>\n                <div className=\"global-score\">\n                    <div className=\"score-value\">{Math.round(globalScore)}</div>\n                    <div className=\"score-label\">Score</div>\n                </div>\n            </div>\n\n            {/* Audit Cards */}\n            <div className=\"audit-cards\">\n                {audits.map(([key, result]) => (\n                    <AuditCard key={key} name={key} result={result} />\n                ))}\n            </div>\n\n            {/* Requirements */}\n            <Requirements auditResults={auditResults} />\n        </div>\n    );\n}\n\nfunction AuditCard({ name, result }) {\n    const getIcon = () => {\n        if (result.passed) return '‚úì';\n        return '‚úó';\n    };\n\n    const getName = () => {\n        const names = {\n            hydraulic: 'üåä Flood Risk',\n            wind: 'üí® Wind Load',\n            thermal: 'üî• Heat Island',\n            seismic: 'üåã Seismic'\n        };\n        return names[name] || name;\n    };\n\n    return (\n        <div className={`audit-card ${result.passed ? 'passed' : 'failed'}`}>\n            <div className=\"card-header\">\n                <span className=\"card-icon\">{getIcon()}</span>\n                <span className=\"card-name\">{getName()}</span>\n            </div>\n            <div className=\"card-score\">{result.score}</div>\n            <div className=\"card-status\">{result.status}</div>\n            {result.data && (\n                <div className=\"card-data\">\n                    {Object.entries(result.data).slice(0, 2).map(([k, v]) => (\n                        <div key={k} className=\"data-item\">\n                            <span className=\"data-label\">{k}:</span>\n                            <span className=\"data-value\">{String(v)}</span>\n                        </div>\n                    ))}\n                </div>\n            )}\n        </div>\n    );\n}\n\nfunction Requirements({ auditResults }) {\n    const allRequirements = Object.entries(auditResults)\n        .flatMap(([key, result]) => \n            (result.requirements || []).map(req => ({ audit: key, requirement: req }))\n        );\n\n    if (allRequirements.length === 0) return null;\n\n    return (\n        <div className=\"requirements-section\">\n            <h3>‚ö†Ô∏è Required Actions</h3>\n            <div className=\"requirements-list\">\n                {allRequirements.map((item, i) => (\n                    <div key={i} className=\"requirement-item\">\n                        <span className=\"req-audit\">{item.audit}:</span>\n                        <span className=\"req-text\">{item.requirement}</span>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n}\n\nexport default AuditResults;\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/AuditResults/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/AuditTimeline/AuditTimeline.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/AuditTimeline/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/ChatPanel/ChatPanel.jsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'onLocationSuggested' is not defined.","line":45,"column":45,"nodeType":"Identifier","messageId":"undef","endLine":45,"endColumn":64},{"ruleId":"no-undef","severity":2,"message":"'onLocationSuggested' is not defined.","line":46,"column":17,"nodeType":"Identifier","messageId":"undef","endLine":46,"endColumn":36}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * ChatPanel - Premium AI Query Interface\n * Vienna Spot-Audit Brain with AI Remediation\n */\nimport { useState, useRef, useEffect } from 'react';\nimport { queryGemini } from '../../services/gemini';\nimport { getRemediationSuggestions } from '../../services/remediation';\nimport './ChatPanel.css';\n\nfunction ChatPanel({ auditContext, auditResults, onApplyFix }) {\n    const [messages, setMessages] = useState([\n        {\n            role: 'assistant',\n            content: 'Hello! I\\'m the Vienna Spot-Audit AI. Ask me anything about building regulations, height limits, heritage zones, or where you can build in Vienna.'\n        }\n    ]);\n    const [input, setInput] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const [isOpen, setIsOpen] = useState(false);\n    const [remediations, setRemediations] = useState(null);\n    const [isGeneratingFix, setIsGeneratingFix] = useState(false);\n    const messagesEndRef = useRef(null);\n    \n    useEffect(() => {\n        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    }, [messages]);\n    \n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        if (!input.trim() || isLoading) return;\n        \n        const userMessage = input.trim();\n        setInput('');\n        setMessages(prev => [...prev, { role: 'user', content: userMessage }]);\n        setIsLoading(true);\n        \n        try {\n            const result = await queryGemini(userMessage, auditContext);\n            \n            setMessages(prev => [...prev, {\n                role: 'assistant',\n                content: result.response\n            }]);\n            \n            if (result.suggestedLocation && onLocationSuggested) {\n                onLocationSuggested(result.suggestedLocation);\n            }\n        } catch (error) {\n            setMessages(prev => [...prev, {\n                role: 'assistant',\n                content: `Sorry, I encountered an error: ${error.message}. Please try again.`,\n                isError: true\n            }]);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n    \n    // Generate AI remediation suggestions\n    const handleGenerateRemediation = async () => {\n        if (!auditResults || isGeneratingFix) return;\n        \n        setIsGeneratingFix(true);\n        setRemediations(null);\n        \n        try {\n            const suggestions = await getRemediationSuggestions(auditResults);\n            setRemediations(suggestions);\n            \n            // Add a message about remediation\n            setMessages(prev => [...prev, {\n                role: 'assistant',\n                content: `üîß I've analyzed your building and found ${suggestions.combined.length} remediation strategies. Click \"Apply\" on any suggestion to update your design.`\n            }]);\n        } catch (error) {\n            console.error('Remediation generation failed:', error);\n            setMessages(prev => [...prev, {\n                role: 'assistant',\n                content: 'Sorry, I couldn\\'t generate remediation suggestions. Please try again.',\n                isError: true\n            }]);\n        } finally {\n            setIsGeneratingFix(false);\n        }\n    };\n    \n    // Apply a remediation action\n    const handleApplyRemediation = (remediation) => {\n        if (remediation.action && onApplyFix) {\n            onApplyFix(remediation.action);\n            setMessages(prev => [...prev, {\n                role: 'assistant',\n                content: `‚úÖ Applied: ${remediation.title}. Re-running audit to verify improvement...`\n            }]);\n        }\n    };\n    \n    // Check if there are violations that need fixing\n    const hasViolations = auditResults?.constraints?.some(\n        c => c.severity === 'critical' || c.severity === 'blocking' || c.severity === 'important'\n    );\n    \n    const quickQuestions = [\n        \"Max height near Stephansdom?\",\n        \"Can I build in a flood zone?\",\n        \"Climate mandates?\"\n    ];\n    \n    // SVG Icons\n    const BotIcon = () => (\n        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <rect x=\"3\" y=\"11\" width=\"18\" height=\"10\" rx=\"2\"/>\n            <circle cx=\"12\" cy=\"5\" r=\"2\"/>\n            <path d=\"M12 7v4\"/>\n            <line x1=\"8\" y1=\"16\" x2=\"8\" y2=\"16\"/>\n            <line x1=\"16\" y1=\"16\" x2=\"16\" y2=\"16\"/>\n        </svg>\n    );\n    \n    const SendIcon = () => (\n        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\"/>\n            <polygon points=\"22 2 15 22 11 13 2 9 22 2\"/>\n        </svg>\n    );\n    \n    const CloseIcon = () => (\n        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"/>\n            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"/>\n        </svg>\n    );\n    \n    const MessageIcon = () => (\n        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/>\n        </svg>\n    );\n    \n    return (\n        <>\n            {/* Toggle Button - Premium FAB */}\n            <button \n                className={`chat-toggle ${isOpen ? 'open' : ''}`}\n                onClick={() => setIsOpen(!isOpen)}\n                title=\"Ask AI about Vienna regulations\"\n            >\n                {isOpen ? <CloseIcon /> : <MessageIcon />}\n            </button>\n            \n            {/* Chat Panel */}\n            <div className={`chat-panel ${isOpen ? 'open' : ''}`}>\n                <div className=\"chat-header\">\n                    <div className=\"chat-icon\">\n                        <BotIcon />\n                    </div>\n                    <span className=\"chat-header-title\">Vienna AI Assistant</span>\n                    <span className=\"chat-status\">Online</span>\n                </div>\n                \n                <div className=\"chat-messages\">\n                    {messages.map((msg, idx) => (\n                        <div \n                            key={idx} \n                            className={`chat-message ${msg.role} ${msg.isError ? 'error' : ''}`}\n                        >\n                            {msg.role === 'assistant' && (\n                                <span className=\"msg-icon\">\n                                    <BotIcon />\n                                </span>\n                            )}\n                            <div className=\"msg-content\">{msg.content}</div>\n                        </div>\n                    ))}\n                    \n                    {isLoading && (\n                        <div className=\"chat-message assistant loading\">\n                            <span className=\"msg-icon\">\n                                <BotIcon />\n                            </span>\n                            <div className=\"msg-content\">\n                                <span className=\"typing-indicator\">\n                                    <span></span><span></span><span></span>\n                                </span>\n                            </div>\n                        </div>\n                    )}\n                    \n                    <div ref={messagesEndRef} />\n                </div>\n                \n                {/* Quick Questions */}\n                {messages.length <= 2 && (\n                    <div className=\"chat-quick\">\n                        {quickQuestions.map((q, idx) => (\n                            <button \n                                key={idx}\n                                onClick={() => setInput(q)}\n                                className=\"quick-btn\"\n                            >\n                                {q}\n                            </button>\n                        ))}\n                    </div>\n                )}\n                \n                {/* Fix Violations Button */}\n                {hasViolations && !remediations && (\n                    <div className=\"remediation-trigger\">\n                        <button \n                            className=\"fix-all-btn\"\n                            onClick={handleGenerateRemediation}\n                            disabled={isGeneratingFix}\n                        >\n                            {isGeneratingFix ? (\n                                <><span className=\"spinner\"></span> Analyzing...</>\n                            ) : (\n                                <>üîß Fix All Violations</>\n                            )}\n                        </button>\n                    </div>\n                )}\n                \n                {/* Remediation Cards */}\n                {remediations && (\n                    <div className=\"remediation-list\">\n                        <div className=\"remediation-header\">\n                            <span>ü§ñ AI Remediation Strategies</span>\n                            <button className=\"close-remediation\" onClick={() => setRemediations(null)}>√ó</button>\n                        </div>\n                        {remediations.combined.map((rem, idx) => (\n                            <div key={idx} className=\"remediation-card\">\n                                <div className=\"rem-icon\">{rem.icon}</div>\n                                <div className=\"rem-content\">\n                                    <div className=\"rem-title\">{rem.title}</div>\n                                    <div className=\"rem-desc\">{rem.description}</div>\n                                    <div className=\"rem-impact\">{rem.impact}</div>\n                                </div>\n                                {rem.action && (\n                                    <button \n                                        className=\"rem-apply-btn\"\n                                        onClick={() => handleApplyRemediation(rem)}\n                                    >\n                                        Apply\n                                    </button>\n                                )}\n                            </div>\n                        ))}\n                    </div>\n                )}\n                \n                <form className=\"chat-input-form\" onSubmit={handleSubmit}>\n                    <input\n                        type=\"text\"\n                        value={input}\n                        onChange={(e) => setInput(e.target.value)}\n                        placeholder=\"Ask about Vienna building rules...\"\n                        disabled={isLoading}\n                    />\n                    <button type=\"submit\" disabled={isLoading || !input.trim()}>\n                        <SendIcon />\n                    </button>\n                </form>\n            </div>\n        </>\n    );\n}\n\nexport default ChatPanel;\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/ChatPanel/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/Layout/Header.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/Layout/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/Map/Map.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'showGeo' and 'showWaterways'. Either include them or remove the dependency array.","line":512,"column":8,"nodeType":"ArrayExpression","endLine":512,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [showGeo, showWaterways]","fix":{"range":[18278,18280],"text":"[showGeo, showWaterways]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Map Component - MapLibre GL integration for Vienna with 3D Buildings\nimport { useEffect, useRef, useState, useCallback } from 'react';\nimport maplibregl from 'maplibre-gl';\nimport 'maplibre-gl/dist/maplibre-gl.css';\nimport './Map.css';\n\n// Import the filtered building data\nimport buildingsData from '../../data/vienna_buildings.json';\nimport waterData from '../../data/vienna_water.json';\nimport { osmWaterToGeoJSON } from '../../services/osm_utils';\n\nexport function Map({ onLocationSelect, onBuildingSelect, envelopeData }) {\n    const mapContainer = useRef(null);\n    const mapRef = useRef(null);\n    const markerRef = useRef(null);\n    const [coords, setCoords] = useState({ lat: 48.2082, lng: 16.3738 });\n    const [show3D, setShow3D] = useState(true);\n    const [showWaterways, setShowWaterways] = useState(true);\n    const [showGeo, setShowGeo] = useState(false);\n    const [showEnvelope, setShowEnvelope] = useState(true);\n    const [hoveredBuilding, setHoveredBuilding] = useState(null);\n    \n    // Use refs for callbacks to prevent map re-initialization on parent re-renders\n    const onLocationSelectRef = useRef(onLocationSelect);\n    const onBuildingSelectRef = useRef(onBuildingSelect);\n    \n    // Keep refs updated with latest callbacks\n    useEffect(() => {\n        onLocationSelectRef.current = onLocationSelect;\n        onBuildingSelectRef.current = onBuildingSelect;\n    }, [onLocationSelect, onBuildingSelect]);\n\n    // Create a custom marker element\n    const createMarkerElement = () => {\n        const el = document.createElement('div');\n        el.className = 'custom-map-marker';\n        el.innerHTML = `\n            <div class=\"marker-pin\">\n                <div class=\"marker-pulse\"></div>\n            </div>\n        `;\n        return el;\n    };\n\n    // Toggle 3D buildings visibility\n    const toggle3D = useCallback(() => {\n        setShow3D(prev => {\n            const newState = !prev;\n            if (mapRef.current && mapRef.current.getLayer('3d-buildings')) {\n                mapRef.current.setLayoutProperty(\n                    '3d-buildings',\n                    'visibility',\n                    newState ? 'visible' : 'none'\n                );\n            }\n            return newState;\n        });\n    }, []);\n\n    // Toggle Danube waterways visibility\n    const toggleWaterways = useCallback(() => {\n        setShowWaterways(prev => {\n            const newState = !prev;\n            if (mapRef.current) {\n                ['danube-glow', 'danube-lines', 'danube-flood-buffer'].forEach(layerId => {\n                    if (mapRef.current.getLayer(layerId)) {\n                        mapRef.current.setLayoutProperty(\n                            layerId,\n                            'visibility',\n                            newState ? 'visible' : 'none'\n                        );\n                    }\n                });\n            }\n            return newState;\n        });\n    }, []);\n\n    // Toggle Geological layers\n    const toggleGeo = useCallback(() => {\n        setShowGeo(prev => {\n            const newState = !prev;\n            if (mapRef.current) {\n                ['geology-fill', 'fault-line', 'fault-glow'].forEach(layerId => {\n                    if (mapRef.current.getLayer(layerId)) {\n                        mapRef.current.setLayoutProperty(\n                            layerId,\n                            'visibility',\n                            newState ? 'visible' : 'none'\n                        );\n                    }\n                });\n            }\n            return newState;\n        });\n    }, []);\n\n    // Toggle Envelope visibility\n    const toggleEnvelope = useCallback(() => {\n        setShowEnvelope(prev => {\n            const newState = !prev;\n            if (mapRef.current && mapRef.current.getLayer('ghost-envelope')) {\n                mapRef.current.setLayoutProperty(\n                    'ghost-envelope',\n                    'visibility',\n                    newState ? 'visible' : 'none'\n                );\n            }\n            return newState;\n        });\n    }, []);\n\n    // Update envelope layer when envelopeData changes\n    useEffect(() => {\n        if (!mapRef.current || !envelopeData) return;\n        \n        const map = mapRef.current;\n        \n        // Create envelope polygon (rectangle around the click point)\n        const { lat, lng, height, offset = 0.0003, isOverLimit, rotation = 0 } = envelopeData;\n        \n        // Color changes based on whether height exceeds limit\n        const envelopeColor = isOverLimit ? '#ff4757' : '#00ff88';\n        const envelopeOpacity = isOverLimit ? 0.35 : 0.25;\n        \n        // Rotate a point around the center\n        const rotatePoint = (x, y, centerX, centerY, angleDeg) => {\n            const angleRad = (angleDeg * Math.PI) / 180;\n            const cos = Math.cos(angleRad);\n            const sin = Math.sin(angleRad);\n            const dx = x - centerX;\n            const dy = y - centerY;\n            return [\n                centerX + dx * cos - dy * sin,\n                centerY + dx * sin + dy * cos\n            ];\n        };\n        \n        // Define corners before rotation\n        const corners = [\n            [lng - offset, lat - offset],\n            [lng + offset, lat - offset],\n            [lng + offset, lat + offset],\n            [lng - offset, lat + offset]\n        ];\n        \n        // Apply rotation to each corner\n        const rotatedCorners = corners.map(([x, y]) => \n            rotatePoint(x, y, lng, lat, rotation)\n        );\n        \n        // Close the polygon\n        rotatedCorners.push(rotatedCorners[0]);\n        \n        const envelopeGeoJSON = {\n            type: 'FeatureCollection',\n            features: [{\n                type: 'Feature',\n                properties: { height },\n                geometry: {\n                    type: 'Polygon',\n                    coordinates: [rotatedCorners]\n                }\n            }]\n        };\n        \n        // Update or add the envelope source/layer\n        if (map.getSource('envelope-source')) {\n            map.getSource('envelope-source').setData(envelopeGeoJSON);\n            // Update colors dynamically\n            map.setPaintProperty('ghost-envelope', 'fill-extrusion-color', envelopeColor);\n            map.setPaintProperty('ghost-envelope', 'fill-extrusion-opacity', envelopeOpacity);\n            map.setPaintProperty('ghost-envelope-outline', 'line-color', envelopeColor);\n        } else {\n            map.addSource('envelope-source', {\n                type: 'geojson',\n                data: envelopeGeoJSON\n            });\n            \n            map.addLayer({\n                id: 'ghost-envelope',\n                type: 'fill-extrusion',\n                source: 'envelope-source',\n                paint: {\n                    'fill-extrusion-color': envelopeColor,\n                    'fill-extrusion-height': ['get', 'height'],\n                    'fill-extrusion-base': 0,\n                    'fill-extrusion-opacity': envelopeOpacity\n                }\n            });\n            \n            // Add envelope outline for better visibility\n            map.addLayer({\n                id: 'ghost-envelope-outline',\n                type: 'line',\n                source: 'envelope-source',\n                paint: {\n                    'line-color': envelopeColor,\n                    'line-width': 2,\n                    'line-opacity': 0.8\n                }\n            });\n        }\n    }, [envelopeData]);\n\n    useEffect(() => {\n        if (mapRef.current) return;\n\n        const map = new maplibregl.Map({\n            container: mapContainer.current,\n            style: {\n                version: 8,\n                sources: {\n                    'carto-dark': {\n                        type: 'raster',\n                        tiles: ['https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}@2x.png'],\n                        tileSize: 256\n                    }\n                },\n                layers: [{\n                    id: 'carto-dark-layer',\n                    type: 'raster',\n                    source: 'carto-dark'\n                }]\n            },\n            center: [16.3738, 48.2082],\n            zoom: 14,\n            pitch: 45,\n            bearing: -17.6,\n            minZoom: 10,\n            maxBounds: [[15.8, 47.9], [16.9, 48.5]]\n        });\n\n        map.addControl(new maplibregl.NavigationControl(), 'top-right');\n\n        map.on('load', () => {\n            // Add buildings source\n            map.addSource('buildings', {\n                type: 'geojson',\n                data: buildingsData\n            });\n\n            // Add 3D building layer\n            map.addLayer({\n                id: '3d-buildings',\n                type: 'fill-extrusion',\n                source: 'buildings',\n                paint: {\n                    'fill-extrusion-color': [\n                        'interpolate',\n                        ['linear'],\n                        ['get', 'height'],\n                        0, '#1a1a2e',\n                        10, '#16213e',\n                        30, '#0f3460',\n                        50, '#533483',\n                        100, '#e94560'\n                    ],\n                    'fill-extrusion-height': ['get', 'height'],\n                    'fill-extrusion-base': 0,\n                    'fill-extrusion-opacity': 0.85\n                }\n            });\n\n            // Add building outlines for better definition\n            map.addLayer({\n                id: 'building-outlines',\n                type: 'line',\n                source: 'buildings',\n                paint: {\n                    'line-color': '#00ff41',\n                    'line-width': 0.5,\n                    'line-opacity': 0.3\n                }\n            });\n\n            // Real Danube Waterways from OSM data\n            const waterGeoJSON = osmWaterToGeoJSON(waterData);\n\n            map.addSource('danube-waterways', {\n                type: 'geojson',\n                data: waterGeoJSON\n            });\n\n            // 1. Flood Risk Buffer (Wide, blurred area simulating HQ100)\n            map.addLayer({\n                id: 'danube-flood-buffer',\n                type: 'line',\n                source: 'danube-waterways',\n                layout: {\n                    'visibility': showWaterways ? 'visible' : 'none',\n                    'line-join': 'round',\n                    'line-cap': 'round'\n                },\n                paint: {\n                    'line-color': '#00d4ff',\n                    'line-width': [\n                        'interpolate', ['exponential', 2], ['zoom'],\n                        10, 30,    // Wider at low zoom\n                        14, 180,   // Much wider at mid zoom\n                        18, 1000   // Very wide at high zoom\n                    ],\n                    'line-opacity': 0.25, // Increased opacity from 0.12\n                    'line-blur': [\n                        'interpolate', ['linear'], ['zoom'],\n                        10, 10,\n                        14, 40,\n                        18, 150\n                    ]\n                }\n            });\n\n            // 2. Danube water glow (mid-width, for better line definition)\n            map.addLayer({\n                id: 'danube-glow',\n                type: 'line',\n                source: 'danube-waterways',\n                layout: {\n                    'visibility': showWaterways ? 'visible' : 'none'\n                },\n                paint: {\n                    'line-color': '#00d4ff',\n                    'line-width': 12,\n                    'line-opacity': 0.45,\n                    'line-blur': 6\n                }\n            });\n\n            // 3. Danube main center-line\n            map.addLayer({\n                id: 'danube-lines',\n                type: 'line',\n                source: 'danube-waterways',\n                layout: {\n                    'visibility': showWaterways ? 'visible' : 'none'\n                },\n                paint: {\n                    'line-color': '#00d4ff',\n                    'line-width': 1.5,\n                    'line-opacity': 0.9\n                }\n            });\n\n            // GEOLOGICAL DATA (Bedrock vs Sediment)\n            const geoZones = {\n                type: 'FeatureCollection',\n                features: [\n                    {\n                        type: 'Feature',\n                        properties: { zone: 'Flysch (Bedrock)', color: '#8b5cf6' },\n                        geometry: {\n                            type: 'Polygon',\n                            coordinates: [[[15.8, 48.5], [16.35, 48.5], [16.35, 47.9], [15.8, 47.9], [15.8, 48.5]]]\n                        }\n                    },\n                    {\n                        type: 'Feature',\n                        properties: { zone: 'Vienna Basin (Sediment)', color: '#ffaa00' },\n                        geometry: {\n                            type: 'Polygon',\n                            coordinates: [[[16.35, 48.5], [16.9, 48.5], [16.9, 47.9], [16.35, 47.9], [16.35, 48.5]]]\n                        }\n                    }\n                ]\n            };\n\n            const faultLine = {\n                type: 'Feature',\n                geometry: {\n                    type: 'LineString',\n                    coordinates: [[16.35, 48.5], [16.35, 47.9]]\n                }\n            };\n\n            map.addSource('geology', { type: 'geojson', data: geoZones });\n            map.addSource('fault', { type: 'geojson', data: faultLine });\n\n            // Geology Fill Layer\n            map.addLayer({\n                id: 'geology-fill',\n                type: 'fill',\n                source: 'geology',\n                layout: { 'visibility': showGeo ? 'visible' : 'none' },\n                paint: {\n                    'fill-color': ['get', 'color'],\n                    'fill-opacity': 0.08\n                }\n            }, 'danube-flood-buffer');\n\n            // Fault Glow\n            map.addLayer({\n                id: 'fault-glow',\n                type: 'line',\n                source: 'fault',\n                layout: { 'visibility': showGeo ? 'visible' : 'none' },\n                paint: {\n                    'line-color': '#ffaa00',\n                    'line-width': 10,\n                    'line-opacity': 0.3,\n                    'line-blur': 5\n                }\n            });\n\n            // Fault Line\n            map.addLayer({\n                id: 'fault-line',\n                type: 'line',\n                source: 'fault',\n                layout: { 'visibility': showGeo ? 'visible' : 'none' },\n                paint: {\n                    'line-color': '#ffaa00',\n                    'line-width': 2,\n                    'line-dasharray': [2, 2]\n                }\n            });\n\n\n\n            // Hover effect\n            map.on('mousemove', '3d-buildings', (e) => {\n                if (e.features.length > 0) {\n                    map.getCanvas().style.cursor = 'pointer';\n                    const feature = e.features[0];\n                    setHoveredBuilding({\n                        name: feature.properties.name || 'Building',\n                        height: feature.properties.height,\n                        levels: feature.properties.levels,\n                        type: feature.properties.type\n                    });\n                }\n            });\n\n            map.on('mouseleave', '3d-buildings', () => {\n                map.getCanvas().style.cursor = '';\n                setHoveredBuilding(null);\n            });\n\n            // Click on building to select it\n            map.on('click', '3d-buildings', (e) => {\n                if (e.features.length > 0) {\n                    const feature = e.features[0];\n                    const coords = e.lngLat;\n                    \n                    // Notify parent about selected building\n                    if (onBuildingSelectRef.current) {\n                        onBuildingSelectRef.current({\n                            lat: coords.lat,\n                            lng: coords.lng,\n                            height: feature.properties.height,\n                            levels: feature.properties.levels,\n                            type: feature.properties.type,\n                            name: feature.properties.name\n                        });\n                    }\n\n                    // Also update location\n                    if (onLocationSelectRef.current) {\n                        onLocationSelectRef.current(coords.lat, coords.lng);\n                    }\n                    setCoords({ lat: coords.lat, lng: coords.lng });\n\n                    // Update marker\n                    if (markerRef.current) {\n                        markerRef.current.setLngLat([coords.lng, coords.lat]);\n                    } else {\n                        markerRef.current = new maplibregl.Marker({\n                            element: createMarkerElement(),\n                            anchor: 'bottom'\n                        })\n                        .setLngLat([coords.lng, coords.lat])\n                        .addTo(map);\n                    }\n\n                    e.preventDefault();\n                }\n            });\n        });\n\n        // Click handler for placing building (on empty areas)\n        map.on('click', (e) => {\n            // Skip if click was on a building (handled above)\n            const features = map.queryRenderedFeatures(e.point, { layers: ['3d-buildings'] });\n            if (features.length > 0) return;\n\n            const { lng, lat } = e.lngLat;\n            setCoords({ lat, lng });\n            \n            // Update marker\n            if (markerRef.current) {\n                markerRef.current.setLngLat([lng, lat]);\n            } else {\n                markerRef.current = new maplibregl.Marker({\n                    element: createMarkerElement(),\n                    anchor: 'bottom'\n                })\n                .setLngLat([lng, lat])\n                .addTo(map);\n            }\n\n            // Notify parent\n            if (onLocationSelectRef.current) {\n                onLocationSelectRef.current(lat, lng);\n            }\n        });\n\n        mapRef.current = map;\n\n        return () => {\n            map.remove();\n            mapRef.current = null;\n        };\n    }, []); // Empty deps - map should only initialize once\n\n    return (\n        <div className=\"map-wrapper\">\n            <div ref={mapContainer} className=\"map-container\" />\n            \n            {/* 3D Toggle Button */}\n            <button \n                className={`map-toggle-3d ${show3D ? 'active' : ''}`}\n                onClick={toggle3D}\n                title={show3D ? 'Hide 3D Buildings' : 'Show 3D Buildings'}\n            >\n                üèóÔ∏è 3D\n            </button>\n\n            {/* Waterways Toggle Button */}\n            <button \n                className={`map-toggle-water ${showWaterways ? 'active' : ''}`}\n                onClick={toggleWaterways}\n                title={showWaterways ? 'Hide Danube' : 'Show Danube'}\n            >\n                üåä Donau\n            </button>\n            \n            {/* NEW Geology Toggle Button */}\n            <button \n                className={`map-toggle-geo ${showGeo ? 'active' : ''}`}\n                onClick={toggleGeo}\n                title={showGeo ? 'Hide Geological Risk' : 'Show Geological Risk'}\n            >\n                üî≠ GEO\n            </button>\n            \n            {/* Envelope Toggle Button */}\n            {envelopeData && (\n                <button \n                    className={`map-toggle-envelope ${showEnvelope ? 'active' : ''}`}\n                    onClick={toggleEnvelope}\n                    title={showEnvelope ? 'Hide Max Envelope' : 'Show Max Envelope'}\n                >\n                    üìê MAX\n                </button>\n            )}\n\n            {/* Hover Tooltip */}\n            {hoveredBuilding && (\n                <div className=\"map-building-tooltip\">\n                    <strong>{hoveredBuilding.name}</strong>\n                    <span>Height: {hoveredBuilding.height?.toFixed(1)}m</span>\n                    <span>Floors: {hoveredBuilding.levels}</span>\n                    <span>Type: {hoveredBuilding.type}</span>\n                </div>\n            )}\n\n            <div className=\"map-coords\">\n                üìç {coords.lat.toFixed(4)}¬∞ N, {coords.lng.toFixed(4)}¬∞ E\n            </div>\n            <div className=\"map-hint\">Click building to select ‚Ä¢ Click empty to place new</div>\n        </div>\n    );\n}\n\nexport default Map;\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/Map/MapLayerToggles.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/Map/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/Onboarding/Onboarding.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  34 |         const hasSeenOnboarding = localStorage.getItem('vienna_spotaudit_onboarding');\n  35 |         if (!hasSeenOnboarding) {\n> 36 |             setIsVisible(true);\n     |             ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  37 |         }\n  38 |     }, []);\n  39 |","line":36,"column":13,"nodeType":null,"endLine":36,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Onboarding Component - Vienna Spot-Audit\nimport { useState, useEffect } from 'react';\nimport './Onboarding.css';\n\nconst ONBOARDING_STEPS = [\n    {\n        title: 'üèõÔ∏è Welcome to Vienna Spot-Audit',\n        content: 'Your intelligent urban planning dashboard. Instantly analyze any location in Districts 1, 2, or 7 for regulatory constraints.',\n        icon: 'üá¶üáπ'\n    },\n    {\n        title: 'üìç Step 1: Click the Map',\n        content: 'Simply click anywhere on the map to analyze that location. No forms needed - instant analysis.',\n        icon: 'üó∫Ô∏è'\n    },\n    {\n        title: 'üîç Step 2: Review Constraints',\n        content: 'See zoning (Bauklasse), heritage (UNESCO/Schutzzone), subway proximity, and climate regulations at a glance.',\n        icon: 'üìã'\n    },\n    {\n        title: 'üìä Step 3: Check Feasibility',\n        content: 'The Telemetry Panel shows your permit feasibility score and lists compulsory add-ons like green roofs and solar panels.',\n        icon: '‚úÖ'\n    }\n];\n\nexport function Onboarding({ onComplete }) {\n    const [isVisible, setIsVisible] = useState(false);\n    const [currentStep, setCurrentStep] = useState(0);\n    const [dontShowAgain, setDontShowAgain] = useState(false);\n\n    useEffect(() => {\n        const hasSeenOnboarding = localStorage.getItem('vienna_spotaudit_onboarding');\n        if (!hasSeenOnboarding) {\n            setIsVisible(true);\n        }\n    }, []);\n\n    const handleNext = () => {\n        if (currentStep < ONBOARDING_STEPS.length - 1) {\n            setCurrentStep(currentStep + 1);\n        } else {\n            handleComplete();\n        }\n    };\n\n    const handlePrev = () => {\n        if (currentStep > 0) {\n            setCurrentStep(currentStep - 1);\n        }\n    };\n\n    const handleComplete = () => {\n        if (dontShowAgain) {\n            localStorage.setItem('vienna_spotaudit_onboarding', 'true');\n        }\n        setIsVisible(false);\n        if (onComplete) onComplete();\n    };\n\n    const handleSkip = () => {\n        localStorage.setItem('vienna_spotaudit_onboarding', 'true');\n        setIsVisible(false);\n        if (onComplete) onComplete();\n    };\n\n    if (!isVisible) return null;\n\n    const step = ONBOARDING_STEPS[currentStep];\n    const isLastStep = currentStep === ONBOARDING_STEPS.length - 1;\n\n    return (\n        <div className=\"onboarding-overlay\">\n            <div className=\"onboarding-modal\">\n                <button className=\"onboarding-close\" onClick={handleSkip}>√ó</button>\n                \n                <div className=\"onboarding-icon\">{step.icon}</div>\n                <h2 className=\"onboarding-title\">{step.title}</h2>\n                <p className=\"onboarding-content\">{step.content}</p>\n\n                <div className=\"onboarding-dots\">\n                    {ONBOARDING_STEPS.map((_, idx) => (\n                        <span \n                            key={idx}\n                            className={`onboarding-dot ${idx === currentStep ? 'active' : ''}`}\n                            onClick={() => setCurrentStep(idx)}\n                        />\n                    ))}\n                </div>\n\n                <div className=\"onboarding-actions\">\n                    <button \n                        className=\"onboarding-btn secondary\"\n                        onClick={handlePrev}\n                        disabled={currentStep === 0}\n                    >\n                        ‚Üê Back\n                    </button>\n                    <button \n                        className=\"onboarding-btn primary\"\n                        onClick={handleNext}\n                    >\n                        {isLastStep ? 'Get Started' : 'Next ‚Üí'}\n                    </button>\n                </div>\n\n                <label className=\"onboarding-checkbox\">\n                    <input \n                        type=\"checkbox\" \n                        checked={dontShowAgain}\n                        onChange={(e) => setDontShowAgain(e.target.checked)}\n                    />\n                    <span>Don't show again</span>\n                </label>\n            </div>\n        </div>\n    );\n}\n\nexport default Onboarding;\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/Onboarding/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/ProgressBar/ProgressBar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/ProgressBar/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/TelemetryPanel/TelemetryPanel.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'handleMaterialToggle' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":108,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":108,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleMaterialToggle"},"fix":{"range":[4652,4877],"text":""},"desc":"Remove unused variable 'handleMaterialToggle'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * TelemetryPanel - Premium Dashboard with Real Audit Data\n * Displays: Gauge, 4 constraint cards with real data, audit scores chart\n */\nimport React, { useEffect, useState } from 'react';\nimport './TelemetryPanel.css';\n\nexport function TelemetryPanel({ results, loading, phase, buildingConfig, onMaterialChange, onConfigChange }) {\n    const [animatedFeasibility, setAnimatedFeasibility] = useState(0);\n    \n    useEffect(() => {\n        if (results?.feasibility) {\n            const timer = setTimeout(() => {\n                setAnimatedFeasibility(results.feasibility);\n            }, 100);\n            return () => clearTimeout(timer);\n        }\n    }, [results?.feasibility]);\n\n    // Loading state - premium animated version\n    if (loading) {\n        return (\n            <div className=\"telemetry-panel\">\n                <div className=\"panel-header\">\n                    <span className=\"breadcrumb\">Home ‚Ä∫ Vienna ‚Ä∫ <strong>Analyzing...</strong></span>\n                </div>\n                \n                <div className=\"loading-hero\">\n                    <div className=\"loading-ring\">\n                        <svg viewBox=\"0 0 100 100\">\n                            <circle cx=\"50\" cy=\"50\" r=\"40\" className=\"ring-bg\" />\n                            <circle cx=\"50\" cy=\"50\" r=\"40\" className=\"ring-progress\" />\n                        </svg>\n                        <div className=\"loading-icon\">üîç</div>\n                    </div>\n                    <h3 className=\"loading-title\">Running Audit</h3>\n                    <p className=\"loading-phase\">{phase || 'Initializing...'}</p>\n                </div>\n\n                <div className=\"loading-steps\">\n                    {['Zoning', 'Heritage', 'Subsurface', 'Climate', 'Structural Safety'].map((step, idx) => (\n                        <div \n                            key={step} \n                            className={`loading-step ${phase === step ? 'active' : ''} ${\n                                ['Zoning', 'Heritage', 'Subsurface', 'Climate', 'Structural Safety'].indexOf(phase) > idx ? 'complete' : ''\n                            }`}\n                        >\n                            <div className=\"step-indicator\">\n                                {['Zoning', 'Heritage', 'Subsurface', 'Climate', 'Structural Safety'].indexOf(phase) > idx ? '‚úì' : (idx + 1)}\n                            </div>\n                            <span className=\"step-label\">{step}</span>\n                        </div>\n                    ))}\n                </div>\n            </div>\n        );\n    }\n\n    // Empty state\n    if (!results || !results.success) {\n        return (\n            <div className=\"telemetry-panel\">\n                <div className=\"panel-header\">\n                    <span className=\"breadcrumb\">Home ‚Ä∫ Vienna ‚Ä∫ <strong>Permit Feasibility Analysis</strong></span>\n                </div>\n                <div className=\"empty-state\">\n                    <div className=\"empty-icon\">üìç</div>\n                    <h3>Select a Location</h3>\n                    <p>Click on the map to analyze permit feasibility</p>\n                </div>\n            </div>\n        );\n    }\n\n    // Extract data from results\n    const { feasibility, district, audits, building } = results;\n    const zoning = audits?.zoning;\n    const heritage = audits?.heritage;\n    const subsurface = audits?.subsurface;\n    const climate = audits?.climate;\n    const seismic = audits?.seismic;\n    const wind = audits?.wind;\n\n    // Helper to get severity class\n    const getSeverityClass = (score) => {\n        if (score >= 80) return 'green';\n        if (score >= 60) return 'orange';\n        return 'red';\n    };\n\n    const regulatoryLimit = zoning?.bauklasse?.maxHeight || 16;\n    const contextualLimit = zoning?.contextualLimit || regulatoryLimit;\n    const suggestedBauklasse = zoning?.suggestedBauklasse;\n    const neighborhoodAvg = zoning?.neighborhood?.avgHeight || 0;\n    const proposedHeight = building?.height || 20;\n    \n    // Scale percentages relative to the contextual limit (which is >= regulatory)\n    const displayMax = Math.max(proposedHeight, contextualLimit, regulatoryLimit);\n    const heightPercent = Math.min((proposedHeight / displayMax) * 100, 100);\n    const regulatoryPercent = Math.min((regulatoryLimit / displayMax) * 100, 100);\n    const neighborPercent = Math.min((neighborhoodAvg / displayMax) * 100, 100);\n\n    const isExceedingRegulatory = proposedHeight > regulatoryLimit;\n    const isExceedingContextual = proposedHeight > contextualLimit;\n    const hasVariancePotential = isExceedingRegulatory && !isExceedingContextual;\n    \n    // Material toggle handler\n    const handleMaterialToggle = () => {\n        if (onMaterialChange) {\n            const newMaterial = buildingConfig?.material === 'CONCRETE' ? 'TIMBER' : 'CONCRETE';\n            onMaterialChange(newMaterial);\n        }\n    };\n    const currentMaterial = buildingConfig?.material || 'CONCRETE';\n    \n    // Building envelope controls\n    const currentHeight = buildingConfig?.height || proposedHeight || 20;\n    const currentFootprint = buildingConfig?.footprint || 200;\n    const currentRotation = buildingConfig?.rotation || 0;\n    const isOverLimit = currentHeight > contextualLimit;\n    \n    const handleHeightChange = (e) => {\n        const newHeight = parseInt(e.target.value);\n        if (onConfigChange) {\n            onConfigChange({ height: newHeight });\n        }\n    };\n    \n    const handleFootprintChange = (e) => {\n        const newFootprint = parseInt(e.target.value);\n        if (onConfigChange) {\n            onConfigChange({ footprint: newFootprint });\n        }\n    };\n    \n    const handleRotationChange = (e) => {\n        const newRotation = parseInt(e.target.value);\n        if (onConfigChange) {\n            onConfigChange({ rotation: newRotation });\n        }\n    };\n\n    return (\n        <div className=\"telemetry-panel\">\n            {/* Header with breadcrumb */}\n            <div className=\"panel-header\">\n                <span className=\"breadcrumb\">\n                    Home ‚Ä∫ Vienna ‚Ä∫ {district ? `District ${district}` : 'Overview'} <strong>Permit Feasibility Analysis</strong>\n                </span>\n            </div>\n\n            {/* Permit Feasibility Gauge */}\n            <div className=\"gauge-section\">\n                <h3 className=\"gauge-title\">Permit Feasibility</h3>\n                <div className=\"gauge-container\">\n                    <svg viewBox=\"0 0 200 110\" className=\"gauge-svg\">\n                        <defs>\n                            <linearGradient id=\"gaugeGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n                                <stop offset=\"0%\" stopColor=\"#00d4ff\" />\n                                <stop offset=\"50%\" stopColor=\"#00ff88\" />\n                                <stop offset=\"100%\" stopColor=\"#ffcc00\" />\n                            </linearGradient>\n                        </defs>\n                        {/* Background arc */}\n                        <path\n                            d=\"M 20 100 A 80 80 0 0 1 180 100\"\n                            fill=\"none\"\n                            stroke=\"#1a2035\"\n                            strokeWidth=\"12\"\n                            strokeLinecap=\"round\"\n                        />\n                        {/* Progress arc */}\n                        <path\n                            d=\"M 20 100 A 80 80 0 0 1 180 100\"\n                            fill=\"none\"\n                            stroke=\"url(#gaugeGrad)\"\n                            strokeWidth=\"12\"\n                            strokeLinecap=\"round\"\n                            strokeDasharray=\"251.2\"\n                            strokeDashoffset={251.2 * (1 - animatedFeasibility / 100)}\n                            className=\"gauge-progress\"\n                        />\n                    </svg>\n                    <div className=\"gauge-center\">\n                        <span className=\"gauge-value\">{feasibility}%</span>\n                        <span className=\"gauge-label\">\n                            {feasibility >= 80 ? 'High Approval Probability' : \n                             feasibility >= 60 ? 'Moderate - Review Required' : \n                             'Low - Significant Issues'}\n                        </span>\n                    </div>\n                </div>\n            </div>\n\n            {/* Active Constraints - 2x2 Grid with REAL DATA */}\n            <div className=\"constraints-section\">\n                <div className=\"section-head\">\n                    <h3>Active Constraints</h3>\n                </div>\n                <div className=\"constraints-grid\">\n                    \n                    {/* Building Envelope Slider Card */}\n                    <div className={`constraint-card envelope-card ${isOverLimit ? 'over-limit' : ''}`}>\n                        <div className=\"card-top\">\n                            <span className=\"card-icon\">üìê</span>\n                            <span className=\"card-title\">Building Envelope</span>\n                            {isOverLimit && <span className=\"limit-warning\">‚ö†Ô∏è OVER LIMIT</span>}\n                        </div>\n                        \n                        <div className=\"envelope-slider\">\n                            <div className=\"slider-row\">\n                                <label>Height</label>\n                                <input \n                                    type=\"range\" \n                                    min=\"5\" \n                                    max=\"100\" \n                                    value={currentHeight}\n                                    onChange={handleHeightChange}\n                                    className={isOverLimit ? 'over' : ''}\n                                />\n                                <span className={`slider-value ${isOverLimit ? 'over' : ''}`}>\n                                    {currentHeight}m\n                                </span>\n                            </div>\n                            <div className=\"slider-row\">\n                                <label>Footprint</label>\n                                <input \n                                    type=\"range\" \n                                    min=\"50\" \n                                    max=\"500\" \n                                    value={currentFootprint}\n                                    onChange={handleFootprintChange}\n                                />\n                                <span className=\"slider-value\">{currentFootprint}„é°</span>\n                            </div>\n                            <div className=\"slider-row\">\n                                <label>Rotation</label>\n                                <input \n                                    type=\"range\" \n                                    min=\"0\" \n                                    max=\"360\" \n                                    value={currentRotation}\n                                    onChange={handleRotationChange}\n                                    className=\"rotation-slider\"\n                                />\n                                <span className=\"slider-value\">{currentRotation}¬∞</span>\n                            </div>\n                        </div>\n                        \n                        <div className=\"envelope-limits\">\n                            <span>Limit: {contextualLimit}m</span>\n                            {isOverLimit && <span className=\"over-text\">+{(currentHeight - contextualLimit).toFixed(0)}m over</span>}\n                        </div>\n                    </div>\n                    \n                    {/* Material Toggle Card */}\n                    <div className=\"constraint-card material-card\">\n                        <div className=\"card-top\">\n                            <span className=\"card-icon\">üèóÔ∏è</span>\n                            <span className=\"card-title\">Construction Material</span>\n                        </div>\n                        <div className=\"material-toggle\">\n                            <button \n                                className={`material-btn ${currentMaterial === 'CONCRETE' ? 'active' : ''}`}\n                                onClick={() => onMaterialChange && onMaterialChange('CONCRETE')}\n                            >\n                                üß± Concrete\n                            </button>\n                            <button \n                                className={`material-btn ${currentMaterial === 'TIMBER' ? 'active' : ''}`}\n                                onClick={() => onMaterialChange && onMaterialChange('TIMBER')}\n                            >\n                                ü™µ Timber (CLT)\n                            </button>\n                        </div>\n                        <div className=\"card-sublabel\">\n                            {currentMaterial === 'TIMBER' \n                                ? '‚úì Carbon-negative ‚Ä¢ Seismic flex bonus' \n                                : 'Standard construction ‚Ä¢ Higher mass'}\n                        </div>\n                    </div>\n                    \n                    {/* Card 1: Height Restriction (Zoning) */}\n                    <div className=\"constraint-card\">\n                        <div className=\"card-top\">\n                            <span className=\"card-icon\">üìè</span>\n                            <span className=\"card-title\">Height Restriction</span>\n                        </div>\n                        <div className={`card-value height-value-row ${!isExceedingRegulatory ? 'green' : hasVariancePotential ? 'orange' : 'red'}`}>\n                            <div className=\"limit-sequence\">\n                                <span>{regulatoryLimit}m</span>\n                                <span className=\"arrow\">‚Üí</span>\n                                <span className=\"context-limit\">{contextualLimit}m</span>\n                            </div>\n                            {hasVariancePotential && <span className=\"variance-tag\">CONTEXT BUMP</span>}\n                        </div>\n                        <div className=\"card-sublabel\">\n                            {hasVariancePotential \n                                ? `Bauklasse ${suggestedBauklasse?.class} Alignment` \n                                : isExceedingContextual \n                                    ? \"Exceeds Neighborhood Scale\" \n                                    : `Verified: ${zoning?.bauklasse?.class || 'III'} Zoning`}\n                        </div>\n                        <div className=\"height-bar-container\">\n                            <div \n                                className={`height-bar-fill ${!isExceedingRegulatory ? 'safe' : hasVariancePotential ? 'variance' : 'exceeded'}`}\n                                style={{ width: `${heightPercent}%` }}\n                            />\n                            {neighborhoodAvg > 0 && (\n                                <div \n                                    className=\"neighborhood-avg-marker\" \n                                    style={{ left: `${neighborPercent}%` }}\n                                    title={`Neighborhood Avg: ${neighborhoodAvg}m`}\n                                />\n                            )}\n                            <div className=\"height-bar-limit regulatory\" style={{ left: `${regulatoryPercent}%` }} title={`Regulatory: ${regulatoryLimit}m`} />\n                            <div className=\"height-bar-limit contextual\" style={{ left: '100%' }} />\n                        </div>\n                        <div className=\"bar-labels\">\n                            <span>0m</span>\n                            <span className=\"proposed-label\">{proposedHeight}m curr.</span>\n                        </div>\n                    </div>\n\n                    {/* Card 2: Heritage Impact */}\n                    <div className=\"constraint-card\">\n                        <div className=\"card-top\">\n                            <span className=\"card-icon\">üèõÔ∏è</span>\n                            <span className=\"card-title\">Heritage Zone</span>\n                        </div>\n                        <div className={`card-value ${heritage?.unescoZone ? 'orange' : 'green'}`}>\n                            {heritage?.unescoZone ? 'UNESCO Buffer' : 'Standard Zone'}\n                        </div>\n                        {heritage?.landmarks && heritage.landmarks.length > 0 ? (\n                            <>\n                                <div className=\"card-sublabel\">\n                                    {heritage.landmarks[0].distance}m from {heritage.landmarks[0].name}\n                                </div>\n                                <div className=\"landmark-indicator\">\n                                    <span className=\"landmark-dot\" />\n                                    <span>Landmark proximity review required</span>\n                                </div>\n                            </>\n                        ) : heritage?.unescoZone ? (\n                            <>\n                                <div className=\"card-sublabel\">Height limit: {heritage.heightLimit || 43}m</div>\n                                <div className=\"landmark-indicator warning\">\n                                    <span className=\"landmark-dot\" />\n                                    <span>MA 19 approval required</span>\n                                </div>\n                            </>\n                        ) : (\n                            <div className=\"card-sublabel\">No heritage restrictions</div>\n                        )}\n                    </div>\n\n                    {/* Card 3: U-Bahn Proximity (Subsurface) */}\n                    <div className=\"constraint-card\">\n                        <div className=\"card-top\">\n                            <span className=\"card-icon\">üöá</span>\n                            <span className=\"card-title\">U-Bahn Proximity</span>\n                        </div>\n                        {subsurface?.nearestLine ? (\n                            <>\n                                <div className={`card-value ${\n                                    subsurface.nearestDistance < 50 ? 'red' : \n                                    subsurface.nearestDistance < 100 ? 'orange' : 'cyan'\n                                }`}>\n                                    {subsurface.nearestDistance}m to {subsurface.nearestLine.name}\n                                </div>\n                                <div className=\"card-sublabel\">\n                                    Near {subsurface.nearestLine.station} ‚Ä¢ Tunnel depth: {subsurface.nearestLine.tunnelDepth}m\n                                </div>\n                                <div className=\"proximity-bar\">\n                                    <div \n                                        className={`proximity-fill ${\n                                            subsurface.nearestDistance < 50 ? 'critical' : \n                                            subsurface.nearestDistance < 100 ? 'warning' : 'safe'\n                                        }`}\n                                        style={{ width: `${Math.min(100, (150 - subsurface.nearestDistance) / 150 * 100)}%` }}\n                                    />\n                                </div>\n                                <div className=\"bar-labels\">\n                                    <span>Critical</span>\n                                    <span>Clear</span>\n                                </div>\n                            </>\n                        ) : (\n                            <div className=\"card-value green\">No U-Bahn nearby</div>\n                        )}\n                    </div>\n\n                    {/* Card 4: Climate Mandates */}\n                    <div className=\"constraint-card\">\n                        <div className=\"card-top\">\n                            <span className=\"card-icon\">üåø</span>\n                            <span className=\"card-title\">Climate</span>\n                        </div>\n                        <div className={`card-value ${\n                            climate?.mandates?.length > 2 ? 'orange' : 'green'\n                        }`}>\n                            {climate?.mandates?.length || 0} Mandates\n                        </div>\n                        {climate?.uhiIntensity && (\n                            <div className=\"card-sublabel\">\n                                UHI Zone: {climate.uhiIntensity.category} (+{climate.uhiIntensity.intensity}¬∞C)\n                            </div>\n                        )}\n                        <div className=\"mandates-list\">\n                            {climate?.mandates?.slice(0, 3).map((mandate, idx) => (\n                                <div key={idx} className=\"mandate-item\">\n                                    <span className=\"mandate-icon\">\n                                        {mandate.type === 'GREEN_ROOF' ? 'üå±' : \n                                         mandate.type === 'SOLAR_INSTALLATION' ? '‚òÄÔ∏è' : \n                                         mandate.type === 'WATER_RETENTION' ? 'üíß' : \n                                         mandate.type === 'FACADE_GREENING' ? 'üåø' : 'üìã'}\n                                    </span>\n                                    <span className=\"mandate-text\">\n                                        {mandate.type.replace(/_/g, ' ').toLowerCase()}\n                                    </span>\n                                </div>\n                            ))}\n                        </div>\n                    </div>\n\n                    {/* Card 5: Structural Safety */}\n                    <div className=\"constraint-card structural-card\">\n                        <div className=\"card-top\">\n                            <span className=\"card-icon\">üèóÔ∏è</span>\n                            <span className=\"card-title\">Structural Safety</span>\n                        </div>\n                        <div className={`card-value ${getSeverityClass(Math.round(((seismic?.score || 0) + (wind?.score || 0)) / 2))}`}>\n                            {Math.round(((seismic?.score || 0) + (wind?.score || 0)) / 2)}% Resilience\n                        </div>\n                        <div className=\"card-sublabel\">\n                            {wind?.data?.neighborCount} Neighbors ‚Ä¢ {seismic?.data?.zone} Zone\n                        </div>\n                        <div className=\"mini-bars-container\">\n                            <div className=\"mini-bar-row\">\n                                <span className=\"mini-label\">Seismic</span>\n                                <div className=\"mini-bar\">\n                                    <div \n                                        className={`mini-fill ${getSeverityClass(100 - (seismic?.data?.stressLevel || 0))}`}\n                                        style={{ width: `${seismic?.data?.stressLevel || 0}%` }}\n                                    />\n                                </div>\n                            </div>\n                            <div className=\"mini-bar-row\">\n                                <span className=\"mini-label\">Wind</span>\n                                <div className=\"mini-bar\">\n                                    <div \n                                        className={`mini-fill ${getSeverityClass(100 - (wind?.data?.stressLevel || 0))}`}\n                                        style={{ width: `${wind?.data?.stressLevel || 0}%` }}\n                                    />\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n\n            {/* Audit Scores Section */}\n            <div className=\"metrics-section\">\n                <h3>Audit Breakdown</h3>\n                \n                <div className=\"audit-scores\">\n                    {[\n                        { name: 'Zoning', score: zoning?.score || 0, icon: 'üèõÔ∏è', color: '#00d4ff' },\n                        { name: 'Heritage', score: heritage?.score || 0, icon: 'üèõÔ∏è', color: '#00ff88' },\n                        { name: 'Subsurface', score: subsurface?.score || 0, icon: 'üöá', color: '#ffaa00' },\n                        { name: 'Climate', score: climate?.score || 0, icon: 'üå°Ô∏è', color: '#ff6b7a' },\n                        { name: 'Structural', score: Math.round(((seismic?.score || 0) + (wind?.score || 0)) / 2), icon: 'üèóÔ∏è', color: '#8b5cf6' }\n                    ].map((audit, idx) => (\n                        <div key={idx} className=\"audit-score-row\">\n                            <div className=\"audit-info\">\n                                <span className=\"audit-icon\">{audit.icon}</span>\n                                <span className=\"audit-name\">{audit.name}</span>\n                            </div>\n                            <div className=\"audit-bar-container\">\n                                <div \n                                    className=\"audit-bar-fill\"\n                                    style={{ \n                                        width: `${audit.score}%`,\n                                        background: audit.color\n                                    }}\n                                />\n                            </div>\n                            <span className={`audit-score ${getSeverityClass(audit.score)}`}>\n                                {audit.score}%\n                            </span>\n                        </div>\n                    ))}\n                </div>\n            </div>\n\n            {/* Key Risk Summary */}\n            {results.keyRisk && results.keyRisk !== 'No critical constraints' && (\n                <div className=\"risk-summary\">\n                    <span className=\"risk-icon\">‚ö†Ô∏è</span>\n                    <span className=\"risk-text\">{results.keyRisk}</span>\n                </div>\n            )}\n\n            {/* Bottom Status Bar */}\n            <div className=\"status-bar\">\n                <div className=\"status-left\">\n                    <span className=\"status-label\">System Status</span>\n                    <span className=\"status-online\">\n                        <span className=\"dot\" />\n                        ONLINE\n                    </span>\n                </div>\n                <span className=\"refresh-text\">\n                    {results.timestamp ? new Date(results.timestamp).toLocaleTimeString() : 'Live'}\n                </span>\n            </div>\n        </div>\n    );\n}\n\nexport default TelemetryPanel;\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/components/TelemetryPanel/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/hooks/useAudit.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/hooks/useSpotAudit.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/app.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'BuildingValidator' is not defined.","line":33,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":33,"endColumn":46},{"ruleId":"no-undef","severity":2,"message":"'BuildingValidator' is not defined.","line":43,"column":28,"nodeType":"Identifier","messageId":"undef","endLine":43,"endColumn":45},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":74,"column":34,"nodeType":"Identifier","messageId":"undef","endLine":74,"endColumn":47},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":74,"column":92,"nodeType":"Identifier","messageId":"undef","endLine":74,"endColumn":105},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":75,"column":31,"nodeType":"Identifier","messageId":"undef","endLine":75,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":75,"column":88,"nodeType":"Identifier","messageId":"undef","endLine":75,"endColumn":101},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":76,"column":36,"nodeType":"Identifier","messageId":"undef","endLine":76,"endColumn":49},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":76,"column":100,"nodeType":"Identifier","messageId":"undef","endLine":76,"endColumn":113},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":77,"column":34,"nodeType":"Identifier","messageId":"undef","endLine":77,"endColumn":47},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":77,"column":92,"nodeType":"Identifier","messageId":"undef","endLine":77,"endColumn":105},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":80,"column":34,"nodeType":"Identifier","messageId":"undef","endLine":80,"endColumn":47},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":81,"column":34,"nodeType":"Identifier","messageId":"undef","endLine":81,"endColumn":47},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":81,"column":91,"nodeType":"Identifier","messageId":"undef","endLine":81,"endColumn":104},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":82,"column":37,"nodeType":"Identifier","messageId":"undef","endLine":82,"endColumn":50},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":83,"column":43,"nodeType":"Identifier","messageId":"undef","endLine":83,"endColumn":56},{"ruleId":"no-undef","severity":2,"message":"'WindLoadAudit' is not defined.","line":96,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":96,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":96,"column":61,"nodeType":"Identifier","messageId":"undef","endLine":96,"endColumn":74},{"ruleId":"no-undef","severity":2,"message":"'ZoningAudit' is not defined.","line":104,"column":31,"nodeType":"Identifier","messageId":"undef","endLine":104,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":104,"column":61,"nodeType":"Identifier","messageId":"undef","endLine":104,"endColumn":74},{"ruleId":"no-undef","severity":2,"message":"'SeismicAudit' is not defined.","line":112,"column":32,"nodeType":"Identifier","messageId":"undef","endLine":112,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":112,"column":63,"nodeType":"Identifier","messageId":"undef","endLine":112,"endColumn":76},{"ruleId":"no-undef","severity":2,"message":"'HydraulicAudit' is not defined.","line":125,"column":34,"nodeType":"Identifier","messageId":"undef","endLine":125,"endColumn":48},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":125,"column":67,"nodeType":"Identifier","messageId":"undef","endLine":125,"endColumn":80},{"ruleId":"no-undef","severity":2,"message":"'ThermalAudit' is not defined.","line":133,"column":32,"nodeType":"Identifier","messageId":"undef","endLine":133,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":133,"column":63,"nodeType":"Identifier","messageId":"undef","endLine":133,"endColumn":76},{"ruleId":"no-undef","severity":2,"message":"'EthicsAudit' is not defined.","line":141,"column":31,"nodeType":"Identifier","messageId":"undef","endLine":141,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":141,"column":61,"nodeType":"Identifier","messageId":"undef","endLine":141,"endColumn":74},{"ruleId":"no-undef","severity":2,"message":"'CertificateGenerator' is not defined.","line":154,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":154,"endColumn":49},{"ruleId":"no-undef","severity":2,"message":"'CertificateGenerator' is not defined.","line":155,"column":24,"nodeType":"Identifier","messageId":"undef","endLine":155,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'RemediationEngine' is not defined.","line":166,"column":28,"nodeType":"Identifier","messageId":"undef","endLine":166,"endColumn":45},{"ruleId":"no-undef","severity":2,"message":"'CertificateGenerator' is not defined.","line":176,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":176,"endColumn":49},{"ruleId":"no-undef","severity":2,"message":"'ExportModule' is not defined.","line":214,"column":16,"nodeType":"Identifier","messageId":"undef","endLine":214,"endColumn":28},{"ruleId":"no-undef","severity":2,"message":"'ExportModule' is not defined.","line":222,"column":16,"nodeType":"Identifier","messageId":"undef","endLine":222,"endColumn":28},{"ruleId":"no-undef","severity":2,"message":"'ExportModule' is not defined.","line":230,"column":16,"nodeType":"Identifier","messageId":"undef","endLine":230,"endColumn":28},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":238,"column":23,"nodeType":"Identifier","messageId":"undef","endLine":238,"endColumn":36},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":239,"column":28,"nodeType":"Identifier","messageId":"undef","endLine":239,"endColumn":41},{"ruleId":"no-undef","severity":2,"message":"'APP_CONSTANTS' is not defined.","line":240,"column":21,"nodeType":"Identifier","messageId":"undef","endLine":240,"endColumn":34},{"ruleId":"no-undef","severity":2,"message":"'BuildingValidator' is not defined.","line":249,"column":29,"nodeType":"Identifier","messageId":"undef","endLine":249,"endColumn":46},{"ruleId":"no-undef","severity":2,"message":"'BuildingValidator' is not defined.","line":253,"column":16,"nodeType":"Identifier","messageId":"undef","endLine":253,"endColumn":33},{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":258,"column":38,"nodeType":"Identifier","messageId":"undef","endLine":258,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":259,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":259,"endColumn":11}],"suppressedMessages":[],"errorCount":41,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * ArchiShield Alpha V2 - Main Orchestrator\n * =========================================\n * Parametric Resilience & Zoning Engine\n * Coordinates all audits, exports, and certificate generation\n */\n\nconst ArchiShieldEngine = {\n    version: '2.0',\n    name: 'ArchiShield Alpha V2',\n\n    /**\n     * Execute complete resilience audit\n     * @param {string} buildingJSON - JSON string of building data\n     * @returns {Object} - Complete audit results\n     */\n    async runAudit(buildingJSON) {\n        const startTime = Date.now();\n        const log = [];\n\n        log.push(\"‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\");\n        log.push(\"‚ïë          ArchiShield Alpha V2 - Resilience Audit Engine       ‚ïë\");\n        log.push(\"‚ïë              Parametric Resilience & Zoning Engine            ‚ïë\");\n        log.push(\"‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\");\n        log.push(\"\");\n        log.push(`[${new Date().toISOString()}] Audit initiated`);\n        log.push(\"\");\n\n        // Step 1: Parse and Validate\n        log.push(\"‚ñì‚ñì‚ñì PHASE 1: DATA INGESTION PROTOCOL ‚ñì‚ñì‚ñì\");\n        log.push(\"\");\n\n        const parseResult = BuildingValidator.parseJSON(buildingJSON);\n        if (!parseResult.success) {\n            log.push(`‚ùå Parse Error: ${parseResult.error}`);\n            return {\n                success: false,\n                error: { type: 'PARSE_ERROR', message: parseResult.error },\n                executionLog: log.join('\\n')\n            };\n        }\n\n        const validation = BuildingValidator.validate(parseResult.data);\n        if (!validation.valid) {\n            log.push(`‚ùå Validation Errors:`);\n            validation.errors.forEach(e => log.push(`   ‚Ä¢ ${e}`));\n            return {\n                success: false,\n                error: { type: 'VALIDATION_ERROR', messages: validation.errors },\n                executionLog: log.join('\\n')\n            };\n        }\n\n        const building = validation.sanitized;\n        log.push(`‚úì Building parsed: \"${building.name}\"`);\n        log.push(`  Height: ${building.height}m | Floors: ${building.floors}`);\n        log.push(`  Footprint: ${building.footprint_area.toLocaleString()} m¬≤`);\n        log.push(`  Total Floor Area: ${building.total_floor_area.toLocaleString()} m¬≤`);\n        log.push(`  Lot Area: ${building.lot_area.toLocaleString()} m¬≤`);\n        log.push(`  Actual FAR: ${building.actualFAR.toFixed(2)}`);\n        log.push(\"\");\n\n        // Show warnings\n        if (validation.warnings.length > 0) {\n            log.push(\"‚ö† Validation Warnings:\");\n            validation.warnings.forEach(w => log.push(`   ‚Ä¢ ${w}`));\n            log.push(\"\");\n        }\n\n        // Step 2: Load Environmental Data\n        log.push(\"‚ñì‚ñì‚ñì PHASE 2: ENVIRONMENTAL & REGULATORY LAYERS ‚ñì‚ñì‚ñì\");\n        log.push(\"\");\n        log.push(\"Environmental Layer (50-year predictive data):\");\n        log.push(`  ‚Ä¢ Seismic: ${APP_CONSTANTS.environmentalData.seismicMagnitude}M (PGA ${APP_CONSTANTS.environmentalData.peakGroundAcceleration}g)`);\n        log.push(`  ‚Ä¢ Wind: ${APP_CONSTANTS.environmentalData.peakWindSpeedMph} mph (${APP_CONSTANTS.environmentalData.peakWindSpeedMs.toFixed(1)} m/s)`);\n        log.push(`  ‚Ä¢ Flood: BFE ${APP_CONSTANTS.environmentalData.baseFloodElevation}m + 1.2m = ${APP_CONSTANTS.environmentalData.designBFE}m`);\n        log.push(`  ‚Ä¢ Thermal: ${APP_CONSTANTS.environmentalData.heatwavePeakTemp}¬∞C for ${APP_CONSTANTS.environmentalData.heatwaveDuration}h`);\n        log.push(\"\");\n        log.push(\"Regulatory Layer (Vienna Urban Code):\");\n        log.push(`  ‚Ä¢ Max FAR: ${APP_CONSTANTS.zoningCode.maxFAR}`);\n        log.push(`  ‚Ä¢ Setback: ${APP_CONSTANTS.zoningCode.setbackFormula} √ó Height (min ${APP_CONSTANTS.zoningCode.minSetbackMeters}m)`);\n        log.push(`  ‚Ä¢ Max Height: ${APP_CONSTANTS.zoningCode.maxBuildingHeight}m`);\n        log.push(`  ‚Ä¢ Max Lot Coverage: ${APP_CONSTANTS.zoningCode.maxLotCoverage * 100}%`);\n        log.push(\"\");\n\n        // Step 3: Execute All Audits\n        log.push(\"‚ñì‚ñì‚ñì PHASE 3: COMPUTATIONAL AUDITS ‚ñì‚ñì‚ñì\");\n        log.push(\"\");\n\n        const auditResults = {};\n        const allRequirements = [];\n        const detailedReasoning = {};\n\n        // Wind Load Audit\n        log.push(\"‚îÅ‚îÅ‚îÅ Wind Load Audit (WLA-V2) ‚îÅ‚îÅ‚îÅ\");\n        auditResults.wind = WindLoadAudit.execute(building, APP_CONSTANTS);\n        log.push(`  Status: ${auditResults.wind.status} | Score: ${auditResults.wind.score.toFixed(1)}`);\n        allRequirements.push(...(auditResults.wind.requirements || []));\n        detailedReasoning.wind = auditResults.wind.reasoning;\n        log.push(\"\");\n\n        // Zoning Audit\n        log.push(\"‚îÅ‚îÅ‚îÅ Zoning Compliance Audit (ZON-V2) ‚îÅ‚îÅ‚îÅ\");\n        auditResults.zoning = ZoningAudit.execute(building, APP_CONSTANTS);\n        log.push(`  Status: ${auditResults.zoning.status} | Score: ${auditResults.zoning.score.toFixed(1)}`);\n        allRequirements.push(...(auditResults.zoning.requirements || []));\n        detailedReasoning.zoning = auditResults.zoning.reasoning;\n        log.push(\"\");\n\n        // Seismic Audit\n        log.push(\"‚îÅ‚îÅ‚îÅ Seismic Integrity Audit (SIA-V2) ‚îÅ‚îÅ‚îÅ\");\n        auditResults.seismic = SeismicAudit.execute(building, APP_CONSTANTS);\n        log.push(`  Status: ${auditResults.seismic.passed ? 'PASSED' : 'FAILED'} | Score: ${auditResults.seismic.score.toFixed(1)}`);\n        allRequirements.push(...(auditResults.seismic.remediations || []).map(r => ({\n            parameter: r.type || 'structural',\n            current: 'Current design',\n            required: r.recommendation || r,\n            citation: 'SIA-V2'\n        })));\n        detailedReasoning.seismic = auditResults.seismic.reasoning;\n        log.push(\"\");\n\n        // Hydraulic Audit\n        log.push(\"‚îÅ‚îÅ‚îÅ Hydraulic Integrity Audit (HIA-V2) ‚îÅ‚îÅ‚îÅ\");\n        auditResults.hydraulic = HydraulicAudit.execute(building, APP_CONSTANTS);\n        log.push(`  Status: ${auditResults.hydraulic.status} | Score: ${auditResults.hydraulic.score.toFixed(1)}`);\n        allRequirements.push(...(auditResults.hydraulic.requirements || []));\n        detailedReasoning.hydraulic = auditResults.hydraulic.reasoning;\n        log.push(\"\");\n\n        // Thermal Audit\n        log.push(\"‚îÅ‚îÅ‚îÅ Passive Thermal Envelope Audit (PTA-V2) ‚îÅ‚îÅ‚îÅ\");\n        auditResults.thermal = ThermalAudit.execute(building, APP_CONSTANTS);\n        log.push(`  Status: ${auditResults.thermal.status} | Score: ${auditResults.thermal.score.toFixed(1)}`);\n        allRequirements.push(...(auditResults.thermal.requirements || []));\n        detailedReasoning.thermal = auditResults.thermal.reasoning;\n        log.push(\"\");\n\n        // Ethics Audit\n        log.push(\"‚îÅ‚îÅ‚îÅ Krems Ethics Protocol (KEP-V2) ‚îÅ‚îÅ‚îÅ\");\n        auditResults.ethics = EthicsAudit.execute(building, APP_CONSTANTS);\n        log.push(`  Status: ${auditResults.ethics.status} | Score: ${auditResults.ethics.score.toFixed(1)}`);\n        if (auditResults.ethics.ethicalWarning) {\n            log.push(`  ‚ö† ETHICAL WARNING: Social impact exceeds threshold`);\n        }\n        allRequirements.push(...(auditResults.ethics.requirements || []));\n        detailedReasoning.ethics = auditResults.ethics.reasoning;\n        log.push(\"\");\n\n        // Step 4: Determine Overall Status\n        log.push(\"‚ñì‚ñì‚ñì PHASE 4: STATUS DETERMINATION ‚ñì‚ñì‚ñì\");\n        log.push(\"\");\n\n        const globalScore = CertificateGenerator.calculateGlobalScore(auditResults);\n        const status = CertificateGenerator.determineStatus(auditResults);\n\n        log.push(`Global Resilience Score: ${globalScore.toFixed(1)}/100`);\n        log.push(`Overall Status: ${status}`);\n        log.push(\"\");\n\n        // Step 5: Generate Remediations if needed\n        let remediations = null;\n        if (status !== 'LEGAL & RESILIENT') {\n            log.push(\"‚ñì‚ñì‚ñì PHASE 5: REMEDIATION GENERATION ‚ñì‚ñì‚ñì\");\n            log.push(\"\");\n            remediations = RemediationEngine.generate(auditResults, building);\n            log.push(\"Recommended modifications generated\");\n            detailedReasoning.remediation = remediations.reasoning || '';\n            log.push(\"\");\n        }\n\n        // Step 6: Generate Certificate\n        log.push(\"‚ñì‚ñì‚ñì PHASE 6: CERTIFICATE GENERATION ‚ñì‚ñì‚ñì\");\n        log.push(\"\");\n\n        const certificate = CertificateGenerator.generate(\n            building,\n            auditResults,\n            globalScore,\n            status,\n            allRequirements\n        );\n\n        log.push(`Certificate Hash: ${certificate.hash}`);\n        log.push(`Requirements Count: ${allRequirements.length}`);\n        log.push(\"\");\n\n        // Execution time\n        const executionTime = Date.now() - startTime;\n        log.push(\"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\");\n        log.push(`Audit completed in ${executionTime}ms`);\n        log.push(\"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\");\n\n        return {\n            success: true,\n            building,\n            auditResults,\n            globalScore,\n            status,\n            allRequirements,\n            remediations,\n            certificate,\n            detailedReasoning,\n            executionLog: log.join('\\n'),\n            executionTime\n        };\n    },\n\n    /**\n     * Export audit results as GeoJSON\n     */\n    exportGeoJSON(auditResult) {\n        if (!auditResult.success) return null;\n        return ExportModule.toGeoJSON(auditResult.building, auditResult);\n    },\n\n    /**\n     * Export audit results as DXF\n     */\n    exportDXF(auditResult) {\n        if (!auditResult.success) return null;\n        return ExportModule.toDXF(auditResult.building, auditResult);\n    },\n\n    /**\n     * Export complete audit data as JSON\n     */\n    exportJSON(auditResult) {\n        if (!auditResult.success) return null;\n        return ExportModule.toAuditJSON(auditResult.building, auditResult);\n    },\n\n    /**\n     * Get environment info\n     */\n    getEnvironment() {\n        return {\n            location: APP_CONSTANTS.location,\n            environmental: APP_CONSTANTS.environmentalData,\n            zoning: APP_CONSTANTS.zoningCode,\n            version: this.version\n        };\n    },\n\n    /**\n     * Quick validation (without full audit)\n     */\n    quickValidate(buildingJSON) {\n        const parseResult = BuildingValidator.parseJSON(buildingJSON);\n        if (!parseResult.success) {\n            return { valid: false, error: parseResult.error };\n        }\n        return BuildingValidator.validate(parseResult.data);\n    }\n};\n\n// Export for module systems\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = ArchiShieldEngine;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/audits/climate.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/audits/ethics.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":245,"column":38,"nodeType":"Identifier","messageId":"undef","endLine":245,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":246,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":246,"endColumn":11}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * ArchiShield Alpha V2 - Krems Ethics Protocol\n * =============================================\n * Calculate shade coverage > 20% of daylight hours ‚Üí Ethical Non-Compliance\n */\n\nconst EthicsAudit = {\n    name: 'Krems Ethics Protocol',\n    code: 'KEP',\n\n    /**\n     * Execute ethics audit with 20% shade threshold\n     */\n    execute(building, env) {\n        const reasoning = [];\n        const calculations = {};\n        const requirements = [];\n        let passed = true;\n        let status = 'LEGAL & RESILIENT';\n        const failureReasons = [];\n        let ethicalWarning = false;\n\n        reasoning.push(\"‚ïê‚ïê‚ïê KREMS ETHICS PROTOCOL (KEP) ‚ïê‚ïê‚ïê\");\n        reasoning.push(`Social Impact Assessment on Adjacent Vulnerable Communities`);\n        reasoning.push(`Named after IMC Krems Innovation Lab - Pioneers of Ethical Architecture`);\n        reasoning.push(`Shade Impact Threshold: ${env.ethicsConstants.maxShadeImpact * 100}% of daylight hours`);\n        reasoning.push(\"\");\n\n        // Step 1: Identify Adjacent Red Zones\n        reasoning.push(\"STEP 1: Red Zone Proximity Analysis\");\n        const redZoneBuffer = env.zoningCode.redZoneBuffer;\n        const adjacentToRedZone = building.adjacent_to_red_zone !== false;\n        \n        calculations.adjacentToRedZone = adjacentToRedZone;\n        calculations.redZoneDirection = building.red_zone_direction || 'south';\n        \n        reasoning.push(`  Red Zone Buffer Distance: ${redZoneBuffer}m`);\n        reasoning.push(`  Adjacent to Red Zone: ${adjacentToRedZone ? 'Yes' : 'No'}`);\n        if (adjacentToRedZone) {\n            reasoning.push(`  Red Zone Direction: ${calculations.redZoneDirection}`);\n            reasoning.push(`  Vienna Designated Red Zones:`);\n            for (const zone of env.ethicsConstants.redZones) {\n                reasoning.push(`    ‚Ä¢ ${zone.name}: ${zone.population.toLocaleString()} residents`);\n            }\n        }\n        reasoning.push(`  [Citation: KEP ¬ß2.1, Vienna Social Equity Code]`);\n        reasoning.push(\"\");\n\n        // Step 2: Calculate Shadow Geometry\n        reasoning.push(\"STEP 2: Shadow Geometry Analysis\");\n        \n        const h = building.height;\n        const lat = building.latitude || env.location.latitude;\n        \n        // Calculate sun angles for winter solstice (worst case shadow)\n        const winterSolsticeAltitude = 90 - lat - 23.5;\n        const summerSolsticeAltitude = 90 - lat + 23.5;\n        const equinoxAltitude = 90 - lat;\n        \n        // Shadow length = height / tan(altitude)\n        const winterShadow = h / Math.tan(winterSolsticeAltitude * Math.PI / 180);\n        const summerShadow = h / Math.tan(summerSolsticeAltitude * Math.PI / 180);\n        const equinoxShadow = h / Math.tan(equinoxAltitude * Math.PI / 180);\n        \n        // Annual average\n        const avgShadowLength = (winterShadow + summerShadow + equinoxShadow * 2) / 4;\n        \n        calculations.winterShadow = winterShadow;\n        calculations.summerShadow = summerShadow;\n        calculations.avgShadowLength = avgShadowLength;\n        \n        reasoning.push(`  Building Height: ${h}m`);\n        reasoning.push(`  Latitude: ${lat.toFixed(4)}¬∞N`);\n        reasoning.push(`  Sun Altitude at Winter Solstice: ${winterSolsticeAltitude.toFixed(1)}¬∞`);\n        reasoning.push(`  Sun Altitude at Summer Solstice: ${summerSolsticeAltitude.toFixed(1)}¬∞`);\n        reasoning.push(\"\");\n        reasoning.push(`  Shadow Lengths:`);\n        reasoning.push(`    Winter Solstice: ${winterShadow.toFixed(1)}m`);\n        reasoning.push(`    Summer Solstice: ${summerShadow.toFixed(1)}m`);\n        reasoning.push(`    Annual Average: ${avgShadowLength.toFixed(1)}m`);\n        reasoning.push(`  [Citation: KEP ¬ß3.1, Solar Geometry]`);\n        reasoning.push(\"\");\n\n        // Step 3: Calculate Shade Coverage Duration\n        reasoning.push(\"STEP 3: Shade Coverage Duration Analysis\");\n        \n        const daylightHours = env.ethicsConstants.daylightHours;\n        \n        // Estimate shadow hours (simplified)\n        // Shadow moves ~15¬∞/hour, building casts significant shadow for ~3-4 hours typically\n        const shadowWidth = building.footprintWidth;\n        const shadowSweptAngle = 2 * Math.atan(shadowWidth / (2 * avgShadowLength)) * 180 / Math.PI;\n        const shadowDuration = Math.min(shadowSweptAngle / 15, 6); // Max 6 hours\n        \n        // Adjust for building orientation and red zone direction\n        let adjustedShadowDuration = shadowDuration;\n        if (calculations.redZoneDirection === 'south') {\n            adjustedShadowDuration *= 1.2; // South-facing shadows are longer in northern hemisphere\n        }\n        \n        const shadePercentage = adjustedShadowDuration / daylightHours;\n        \n        calculations.daylightHours = daylightHours;\n        calculations.shadowDuration = adjustedShadowDuration;\n        calculations.shadePercentage = shadePercentage;\n        \n        reasoning.push(`  Daily Daylight Hours (average): ${daylightHours}`);\n        reasoning.push(`  Shadow Width: ${shadowWidth.toFixed(1)}m`);\n        reasoning.push(`  Estimated Shadow Duration: ${adjustedShadowDuration.toFixed(1)} hours`);\n        reasoning.push(`  Shade Coverage: ${(shadePercentage * 100).toFixed(1)}% of daylight`);\n        reasoning.push(`  Maximum Allowed: ${(env.ethicsConstants.maxShadeImpact * 100)}%`);\n        reasoning.push(`  [Citation: KEP ¬ß3.2, Shade Duration Calculation]`);\n        reasoning.push(\"\");\n\n        // Step 4: Check Shade Impact Threshold\n        reasoning.push(\"STEP 4: Ethical Shade Impact Assessment\");\n        \n        if (adjacentToRedZone && shadePercentage > env.ethicsConstants.maxShadeImpact) {\n            passed = false;\n            status = 'NON-COMPLIANT';\n            ethicalWarning = true;\n            failureReasons.push(`Shade coverage ${(shadePercentage * 100).toFixed(1)}% exceeds ${(env.ethicsConstants.maxShadeImpact * 100)}% ethical limit`);\n            reasoning.push(`  ‚ùå ETHICAL NON-COMPLIANCE`);\n            reasoning.push(`  ‚Üí Solar access vital for passive heating in low-income housing`);\n            reasoning.push(`  ‚Üí Health impacts: Reduced Vitamin D, increased heating costs`);\n            \n            requirements.push({\n                parameter: \"shade_coverage\",\n                current: `${(shadePercentage * 100).toFixed(1)}% of daylight hours`,\n                required: `‚â§${(env.ethicsConstants.maxShadeImpact * 100)}%`,\n                action: \"Reduce building height or implement stepped massing on Red Zone side\",\n                citation: \"KEP ¬ß4.1, Solar Access Rights\"\n            });\n            \n            // Calculate required height reduction\n            const maxAllowedShadow = avgShadowLength * (env.ethicsConstants.maxShadeImpact / shadePercentage);\n            const maxAllowedHeight = maxAllowedShadow * Math.tan(equinoxAltitude * Math.PI / 180);\n            \n            requirements.push({\n                parameter: \"building_height_for_ethics\",\n                current: `${h}m`,\n                required: `‚â§${maxAllowedHeight.toFixed(1)}m on Red Zone side`,\n                action: \"Step back upper floors by 30% or reduce overall height\",\n                citation: \"KEP ¬ß4.2\"\n            });\n        } else if (adjacentToRedZone) {\n            reasoning.push(`  ‚úì ETHICAL COMPLIANCE: Shade impact within limits`);\n        } else {\n            reasoning.push(`  ‚úì NOT APPLICABLE: Not adjacent to Red Zones`);\n        }\n        reasoning.push(\"\");\n\n        // Step 5: Water Displacement Analysis\n        reasoning.push(\"STEP 5: Water Displacement Impact\");\n        \n        const footprintArea = building.footprint_area;\n        const localDrainageCapacity = 10000; // m¬≤ baseline\n        const waterDisplacement = footprintArea / localDrainageCapacity;\n        \n        calculations.waterDisplacement = waterDisplacement;\n        \n        reasoning.push(`  Building Footprint: ${footprintArea.toLocaleString()} m¬≤`);\n        reasoning.push(`  Local Drainage Capacity: ${localDrainageCapacity.toLocaleString()} m¬≤`);\n        reasoning.push(`  Water Displacement Ratio: ${(waterDisplacement * 100).toFixed(1)}%`);\n        reasoning.push(`  Maximum Allowed: ${(env.ethicsConstants.waterDisplacementLimit * 100)}%`);\n        reasoning.push(`  [Citation: KEP ¬ß5.1, Stormwater Impact]`);\n        \n        if (adjacentToRedZone && waterDisplacement > env.ethicsConstants.waterDisplacementLimit) {\n            passed = false;\n            status = 'NON-COMPLIANT';\n            ethicalWarning = true;\n            failureReasons.push(`Water displacement ${(waterDisplacement * 100).toFixed(1)}% exceeds ${env.ethicsConstants.waterDisplacementLimit * 100}% limit`);\n            reasoning.push(`  ‚ùå ETHICAL NON-COMPLIANCE: Flood risk to adjacent Red Zone`);\n            \n            requirements.push({\n                parameter: \"water_displacement\",\n                current: `${(waterDisplacement * 100).toFixed(1)}%`,\n                required: `‚â§${(env.ethicsConstants.waterDisplacementLimit * 100)}%`,\n                action: \"Install on-site detention basin or permeable surfaces\",\n                citation: \"KEP ¬ß5.2\"\n            });\n        } else {\n            reasoning.push(`  ‚úì COMPLIANT: Water displacement within limits`);\n        }\n        reasoning.push(\"\");\n\n        // Step 6: Calculate Affected Population\n        reasoning.push(\"STEP 6: Affected Population Estimation\");\n        \n        const shadowArea = avgShadowLength * shadowWidth;\n        const typicalLotSize = 300;\n        const affectedLots = Math.ceil(shadowArea / typicalLotSize);\n        const affectedResidents = affectedLots * 4;\n        \n        calculations.shadowArea = shadowArea;\n        calculations.affectedResidents = affectedResidents;\n        \n        reasoning.push(`  Shadow Projection Area: ${shadowArea.toFixed(0)} m¬≤`);\n        reasoning.push(`  Estimated Affected Lots: ${affectedLots}`);\n        reasoning.push(`  Estimated Affected Residents: ${affectedResidents}`);\n        reasoning.push(`  [Citation: KEP ¬ß6.1]`);\n        reasoning.push(\"\");\n\n        // Calculate score\n        let score = 100;\n        if (adjacentToRedZone) {\n            if (shadePercentage > env.ethicsConstants.maxShadeImpact) {\n                score -= 40 * (shadePercentage / env.ethicsConstants.maxShadeImpact);\n            }\n            if (waterDisplacement > env.ethicsConstants.waterDisplacementLimit) {\n                score -= 30 * (waterDisplacement / env.ethicsConstants.waterDisplacementLimit);\n            }\n        }\n        score = Math.max(0, Math.min(100, score));\n        calculations.score = score;\n\n        reasoning.push(\"‚ïê‚ïê‚ïê ETHICS AUDIT SUMMARY ‚ïê‚ïê‚ïê\");\n        reasoning.push(`  Score: ${score.toFixed(1)}/100`);\n        reasoning.push(`  Status: ${status}`);\n        if (ethicalWarning) {\n            reasoning.push(`  ‚ö† ETHICAL NON-COMPLIANCE WARNING`);\n        }\n        if (!passed) {\n            reasoning.push(`  Violations: ${failureReasons.join('; ')}`);\n        }\n        reasoning.push(\"\");\n        reasoning.push(`  \"Architecture must serve all of humanity, not just those who can afford it.\"`);\n        reasoning.push(`  ‚Äî Krems Ethics Declaration, 2029`);\n\n        return {\n            auditName: this.name,\n            auditCode: this.code,\n            passed,\n            status,\n            score,\n            failureReasons,\n            calculations,\n            requirements,\n            reasoning: reasoning.join('\\n'),\n            ethicalWarning\n        };\n    }\n};\n\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = EthicsAudit;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/audits/heritage.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/audits/index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/audits/seismic.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'lat' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":20,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"lat"},"fix":{"range":[670,674],"text":""},"desc":"Remove unused variable 'lat'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'effectiveHeight' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":48,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":30}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Seismic Resilience Audit Service\n * Evaluates building safety against geological and structural parameters.\n * Supports material-aware calculations for Concrete vs Timber structures.\n */\n\n// Material properties affecting seismic performance\nconst MATERIAL_PROPERTIES = {\n    CONCRETE: { weightMultiplier: 1.0, flexibility: 0.8, carbonFactor: 1.0, label: 'Reinforced Concrete' },\n    TIMBER: { weightMultiplier: 0.55, flexibility: 1.2, carbonFactor: 0.3, label: 'Cross-Laminated Timber (CLT)' }\n};\n\nexport const SeismicAudit = {\n    id: 'seismic',\n    name: 'Seismic Resilience Audit',\n\n    execute(building) {\n        if (!building) return null;\n\n        const { lat, lng, height, material = 'CONCRETE' } = building;\n        const materialProps = MATERIAL_PROPERTIES[material] || MATERIAL_PROPERTIES.CONCRETE;\n        const reasoning = [];\n        let status = 'PASSED';\n        let score = 100;\n        const requirements = [];\n\n        // 1. Determine Geological Zone\n        // Boundary approx longitude 16.35\n        let zone = 'Unknown';\n        let pga = 0.0;\n        let amplification = 1.0;\n\n        if (lng < 16.35) {\n            zone = 'Flysch Zone (Bedrock)';\n            pga = 0.06;\n            amplification = 1.0;\n            reasoning.push(\"Geological Zone: Flysch (Bedrock) - Stable Foundation\");\n        } else {\n            zone = 'Vienna Basin (Sediment)';\n            pga = 0.08;\n            amplification = 1.4;\n            reasoning.push(\"Geological Zone: Vienna Basin (Sediment) - Amplification Risk\");\n        }\n\n        // 2. Structural Integrity Check\n        // Buildings over 40m in the sediment zone are higher risk\n        // Timber structures get a bonus due to lower mass and higher flexibility\n        const effectiveHeight = height * materialProps.weightMultiplier;\n        \n        if (zone === 'Vienna Basin (Sediment)' && height > 40) {\n            if (material === 'TIMBER') {\n                // CLT is actually good for seismic - lightweight and flexible\n                score = 90;\n                reasoning.push(`‚úì CLT structure benefits from low mass and high ductility in sediment zone.`);\n                requirements.push(\"Verify CLT connections per EN 1995-1-1 for seismic\");\n            } else {\n                // Concrete is heavier, more risk in sediment\n                score = 75;\n                requirements.push(\"Damping System: Tuned Mass Damper Recommended for optimal resilience\");\n                reasoning.push(`‚ö† WARNING: High-rise concrete in sediment zone. Seismic damping recommended.`);\n            }\n        } else if (zone === 'Flysch Zone (Bedrock)') {\n            score = 98;\n            reasoning.push(\"‚úì PASS: Building sits on stable bedrock foundation.\");\n        } else {\n            // Timber bonus for standard sediment zone\n            const timberBonus = material === 'TIMBER' ? 5 : 0;\n            score = 92 + timberBonus;\n            reasoning.push(`‚úì PASS: Standard seismic compliance within sediment zone.${timberBonus ? ' (CLT bonus applied)' : ''}`);\n        }\n\n        return {\n            id: this.id,\n            name: this.name,\n            status,\n            score,\n            passed: status === 'PASSED',\n            requirements,\n            reasoning: reasoning.join('. '),\n            data: {\n                zone,\n                pga: `${pga}g`,\n                amplification: `${amplification}x`,\n                stressLevel: this.calculateStress(height, amplification, materialProps.weightMultiplier),\n                material: materialProps.label,\n                materialBonus: material === 'TIMBER' ? 'Lightweight CLT reduces seismic load' : null\n            }\n        };\n    },\n\n    calculateStress(height, amplification, materialWeight = 1.0) {\n        // Stress increases with height and soil amplification\n        // Lighter materials (timber) reduce stress significantly\n        // Range 0-100\n        const baseStress = (height / 80) * 50; // Max height in dataset usually around 80m\n        const soilFactor = amplification > 1 ? 1.4 : 1.0;\n        const materialFactor = materialWeight;\n        return Math.min(Math.round(baseStress * soilFactor * materialFactor), 100);\n    }\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/audits/subsurface.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'context' is assigned a value but never used.","line":65,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":65,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"context"},"fix":{"range":[2015,2029],"text":""},"desc":"Remove unused variable 'context'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Subsurface Audit - U-Bahn Tunnel Proximity Analysis\n * \n * Evaluates building location against Vienna's subsurface infrastructure:\n * - U-Bahn tunnel proximity (U1, U2, U3, U4)\n * - Vibration zone assessment\n * - Foundation depth recommendations\n * - Excavation restrictions\n */\n\nimport { getDistance } from '../spatial';\n\n// U-Bahn tunnel centerlines (simplified as point arrays)\nconst UBAHN_LINES = {\n    U1: {\n        color: '#E20E17',\n        stations: [\n            { name: 'Stephansplatz', lat: 48.2084, lng: 16.3725 },\n            { name: 'Schwedenplatz', lat: 48.2120, lng: 16.3775 },\n            { name: 'Praterstern', lat: 48.2189, lng: 16.3917 }\n        ],\n        tunnelDepth: 20 // meters below surface (average)\n    },\n    U2: {\n        color: '#9A57A3',\n        stations: [\n            { name: 'Rathaus', lat: 48.2107, lng: 16.3565 },\n            { name: 'Schottentor', lat: 48.2154, lng: 16.3611 },\n            { name: 'Praterstern', lat: 48.2189, lng: 16.3917 }\n        ],\n        tunnelDepth: 15\n    },\n    U3: {\n        color: '#F39200',\n        stations: [\n            { name: 'Stephansplatz', lat: 48.2084, lng: 16.3725 },\n            { name: 'Herrengasse', lat: 48.2107, lng: 16.3658 },\n            { name: 'Volkstheater', lat: 48.2052, lng: 16.3589 }\n        ],\n        tunnelDepth: 18\n    },\n    U4: {\n        color: '#228B22',\n        stations: [\n            { name: 'Schwedenplatz', lat: 48.2120, lng: 16.3775 },\n            { name: 'Landstra√üe', lat: 48.2063, lng: 16.3868 },\n            { name: 'Karlsplatz', lat: 48.2007, lng: 16.3692 }\n        ],\n        tunnelDepth: 12\n    }\n};\n\n// Proximity thresholds (meters)\nconst THRESHOLDS = {\n    critical: 30,    // Construction ban without special permit\n    restricted: 50,  // Enhanced structural assessment required\n    monitoring: 100, // Vibration monitoring during construction\n    clear: 150       // No special requirements\n};\n\nexport const SubsurfaceAudit = {\n    name: 'Subsurface',\n    icon: 'üöá',\n    \n    execute(building, context = {}) {\n        const { latitude, longitude, basementDepth = 5 } = building;\n        \n        const results = {\n            passed: true,\n            score: 100,\n            nearestLine: null,\n            nearestDistance: Infinity,\n            constraints: [],\n            recommendations: []\n        };\n        \n        // Check proximity to all U-Bahn lines\n        for (const [lineName, line] of Object.entries(UBAHN_LINES)) {\n            for (const station of line.stations) {\n                const distance = getDistance(latitude, longitude, station.lat, station.lng);\n                \n                if (distance < results.nearestDistance) {\n                    results.nearestDistance = Math.round(distance);\n                    results.nearestLine = {\n                        name: lineName,\n                        station: station.name,\n                        color: line.color,\n                        tunnelDepth: line.tunnelDepth\n                    };\n                }\n            }\n        }\n        \n        // Evaluate proximity level\n        const dist = results.nearestDistance;\n        \n        if (dist < THRESHOLDS.critical) {\n            results.passed = false;\n            results.score -= 50;\n            results.constraints.push({\n                type: 'TUNNEL_CRITICAL',\n                severity: 'blocking',\n                message: `${dist}m from ${results.nearestLine.name} tunnel - CONSTRUCTION BAN without Wiener Linien approval`,\n                distance: dist,\n                line: results.nearestLine.name\n            });\n        } else if (dist < THRESHOLDS.restricted) {\n            results.score -= 30;\n            results.constraints.push({\n                type: 'TUNNEL_RESTRICTED',\n                severity: 'critical',\n                message: `${dist}m from ${results.nearestLine.name} - Enhanced structural assessment required`,\n                distance: dist,\n                requirements: ['Geotechnical study', 'Vibration analysis', 'Wiener Linien coordination']\n            });\n        } else if (dist < THRESHOLDS.monitoring) {\n            results.score -= 10;\n            results.constraints.push({\n                type: 'TUNNEL_MONITORING',\n                severity: 'warning',\n                message: `${dist}m from ${results.nearestLine.name} - Vibration monitoring required during construction`,\n                distance: dist\n            });\n        }\n        \n        // Check basement depth conflict\n        if (results.nearestLine && basementDepth > 0) {\n            const tunnelDepth = results.nearestLine.tunnelDepth;\n            if (basementDepth > tunnelDepth - 5) {\n                results.score -= 20;\n                results.constraints.push({\n                    type: 'DEPTH_CONFLICT',\n                    severity: 'critical',\n                    message: `Basement depth ${basementDepth}m may conflict with tunnel at ${tunnelDepth}m`,\n                    recommendation: `Max recommended: ${tunnelDepth - 8}m`\n                });\n            }\n        }\n        \n        // Generate recommendations\n        if (dist < THRESHOLDS.monitoring) {\n            results.recommendations.push('Engage Wiener Linien for pre-construction consultation');\n            results.recommendations.push('Install vibration monitoring equipment');\n        }\n        if (dist < THRESHOLDS.restricted) {\n            results.recommendations.push('Commission independent geotechnical assessment');\n            results.recommendations.push('Consider pile foundation alternatives');\n        }\n        if (dist >= THRESHOLDS.clear) {\n            results.recommendations.push('No subsurface constraints - standard foundation permissible');\n        }\n        \n        results.score = Math.max(0, results.score);\n        return results;\n    }\n};\n\nexport default SubsurfaceAudit;\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/audits/wind_load.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/audits/zoning.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/constants.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/gemini.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/legacy/hydraulic.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/legacy/seismic.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used.","line":7,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[155,163],"text":""},"desc":"Remove unused variable 'config'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Seismic Audit Service\nexport const SeismicAudit = {\n    name: 'Seismic Resilience Audit',\n    code: 'SRA-2036',\n    id: 'seismic',\n\n    execute(building, config) {\n        const reasoning = [];\n        reasoning.push(\"‚ïê‚ïê‚ïê SEISMIC RESILIENCE AUDIT (SRA-2036) ‚ïê‚ïê‚ïê\");\n\n        let zone = 'Unknown';\n        let pga = 0.0;\n        let amplification = 1.0;\n\n        if (building.longitude < 16.35) {\n            zone = 'Flysch Zone (Bedrock)';\n            pga = 0.06;\n            amplification = 1.0;\n            reasoning.push(\"Zone: Flysch (Bedrock) - Stable\");\n        } else {\n            zone = 'Vienna Basin (Sediment)';\n            pga = 0.08;\n            amplification = 1.4;\n            reasoning.push(\"Zone: Vienna Basin (Sediment) - Amplification Risk\");\n        }\n\n        const height = building.height || 30;\n        const structure = building.structural_system || 'reinforced_concrete';\n\n        let status = 'PASSED';\n        let score = 100;\n        const requirements = [];\n\n        if (zone === 'Vienna Basin (Sediment)' && height > 40) {\n            if (structure === 'masonry' || structure === 'bearing_wall' || structure === 'timber') {\n                status = 'FAILED';\n                score = 30;\n                requirements.push(\"Structural System Change: Reinforced Concrete or Steel\");\n                reasoning.push(`‚ùå FAIL: ${height}m with ${structure} in sediment zone.`);\n            } else {\n                score = 80;\n                requirements.push(\"Damping System: Tuned Mass Damper Recommended\");\n                reasoning.push(\"‚ö† WARNING: Tall building in sediment zone.\");\n            }\n        } else if (zone === 'Flysch Zone (Bedrock)') {\n            score = 98;\n            reasoning.push(\"‚úì PASS: Stable bedrock foundation.\");\n        }\n\n        return {\n            status, score, passed: status === 'PASSED',\n            requirements, reasoning: reasoning.join('\\n'),\n            data: { zone, pga: pga + 'g', amplification: amplification + 'x' }\n        };\n    }\n};\n\nexport default SeismicAudit;\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/legacy/thermal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/legacy/wind.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/legacy/wind_load.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'config' is defined but never used.","line":17,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"config"},"fix":{"range":[435,443],"text":""},"desc":"Remove unused variable 'config'."}]},{"ruleId":"no-undef","severity":2,"message":"'map' is not defined.","line":29,"column":32,"nodeType":"Identifier","messageId":"undef","endLine":29,"endColumn":35},{"ruleId":"no-undef","severity":2,"message":"'SpatialUtils' is not defined.","line":31,"column":35,"nodeType":"Identifier","messageId":"undef","endLine":31,"endColumn":47},{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":95,"column":38,"nodeType":"Identifier","messageId":"undef","endLine":95,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":96,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":96,"endColumn":11}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * ArchiShield Pro - Wind Load Audit\n * Real-Data Enabled: Counts neighboring buildings for shielding calculation.\n */\n\nconst WindLoadAudit = {\n    name: 'Wind Load Audit',\n    code: 'WLA-2036',\n    id: 'wind_load',\n\n    /**\n     * Execute wind audit\n     * @param {Object} building - Building data\n     * @param {Object} config - Environmental config (SOFIA_2036)\n     * @returns {Object} Audit result\n     */\n    execute(building, config) {\n        const reasoning = [];\n        reasoning.push(\"‚ïê‚ïê‚ïê WIND LOAD AUDIT (WLA-2036) - Real Data ‚ïê‚ïê‚ïê\");\n\n        // 1. Calculate Shielding via Neighbor Count\n        let neighborCount = 0;\n        const radius = 150;\n        const sectors = ['nw', 'ne', 'sw', 'se'];\n        let dataFound = false;\n\n        if (typeof map !== 'undefined' && typeof SpatialUtils !== 'undefined') {\n            for (const sector of sectors) {\n                const source = map.getSource(`buildings-${sector}`);\n                if (source && source._data && source._data.features) {\n                    const count = SpatialUtils.countFeaturesInRadius(\n                        { lat: building.latitude, lng: building.longitude },\n                        source._data.features,\n                        radius\n                    );\n                    neighborCount += count;\n                    if (source._data.features.length > 0) dataFound = true;\n                }\n            }\n            reasoning.push(`Real Data: Found ${neighborCount} buildings within ${radius}m`);\n        }\n\n        if (!dataFound) {\n            neighborCount = 5;\n            reasoning.push(\"‚ö†Ô∏è No sector data loaded. Using fallback (5 neighbors).\");\n        }\n\n        // 2. Evaluate\n        let status = 'PASSED';\n        let score = 100;\n        let shielding = 'Moderate';\n        const requirements = [];\n\n        if (neighborCount < 3) {\n            status = 'FAILED';\n            score = 65;\n            shielding = 'None (Exposed)';\n            requirements.push(\"High-Wind Bracing: Facade Class A+\");\n            reasoning.push(\"‚ùå FAIL: Site is exposed (< 3 neighbors). High wind loads expected.\");\n        } else if (neighborCount < 10) {\n            score = 90;\n            shielding = 'Low';\n            reasoning.push(\"‚úì Low Shielding: Some wind exposure but manageable.\");\n        } else {\n            score = 98;\n            shielding = 'High (Protected)';\n            reasoning.push(\"‚úì High Shielding: Well protected by surrounding buildings.\");\n        }\n\n        // Height Penalty\n        if (building.height > 60 && shielding === 'None (Exposed)') {\n            status = 'FAILED';\n            score = 40;\n            requirements.push(\"Aerodynamic Shaping: Wind Tunnel Test Required\");\n            reasoning.push(\"‚ùå CRITICAL: Tall + Exposed = Dangerous.\");\n        }\n\n        reasoning.push(`Shielding Factor: ${shielding}`);\n        reasoning.push(`Neighbors in Radius: ${neighborCount}`);\n\n        return {\n            status: status,\n            score: score,\n            passed: status === 'PASSED',\n            requirements: requirements,\n            reasoning: reasoning.join('\\n'),\n            data: {\n                shielding: shielding,\n                neighborCount: neighborCount\n            }\n        };\n    }\n};\n\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = WindLoadAudit;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/osm_utils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/remediation.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'building' is defined but never used.","line":28,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"building"},"fix":{"range":[1084,1094],"text":""},"desc":"Remove unused variable 'building'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'constraint' is defined but never used.","line":39,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"constraint"},"fix":{"range":[1584,1595],"text":""},"desc":"Remove unused variable 'constraint'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'building' is defined but never used.","line":39,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"building"},"fix":{"range":[1594,1604],"text":""},"desc":"Remove unused variable 'building'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'constraint' is defined but never used.","line":50,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"constraint"},"fix":{"range":[2034,2045],"text":""},"desc":"Remove unused variable 'constraint'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'building' is defined but never used.","line":50,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"building"},"fix":{"range":[2044,2054],"text":""},"desc":"Remove unused variable 'building'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'building' is defined but never used.","line":61,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"building"},"fix":{"range":[2465,2475],"text":""},"desc":"Remove unused variable 'building'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'constraint' is defined but never used.","line":72,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":72,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"constraint"},"fix":{"range":[2880,2891],"text":""},"desc":"Remove unused variable 'constraint'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'building' is defined but never used.","line":72,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":72,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"building"},"fix":{"range":[2890,2900],"text":""},"desc":"Remove unused variable 'building'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'constraint' is defined but never used.","line":83,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":83,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"constraint"},"fix":{"range":[3297,3308],"text":""},"desc":"Remove unused variable 'constraint'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'building' is defined but never used.","line":83,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":83,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"building"},"fix":{"range":[3307,3317],"text":""},"desc":"Remove unused variable 'building'."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Remediation Service - AI-Powered Building Fix Suggestions\n * \n * Provides both rule-based and AI-generated remediation strategies\n * for buildings that fail regulatory audits.\n */\n\nconst GEMINI_API_KEY = import.meta.env.VITE_GEMINI_API_KEY;\nconst GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1/models/gemini-2.5-flash:generateContent';\n\n/**\n * Rule-based remediation strategies for common violations\n */\nconst REMEDIATION_RULES = {\n    HEIGHT_VIOLATION: {\n        priority: 1,\n        getRemediation: (constraint, building) => ({\n            type: 'HEIGHT_REDUCTION',\n            title: 'Reduce Building Height',\n            description: `Lower the building height from ${building.height}m to ${constraint.limit}m to comply with ${constraint.contextualLimit ? 'Urban Fabric' : 'Bauklasse'} limits.`,\n            action: { height: constraint.contextualLimit || constraint.limit },\n            impact: 'Resolves zoning violation',\n            icon: 'üìè'\n        })\n    },\n    HEIGHT_VARIANCE_OPPORTUNITY: {\n        priority: 2,\n        getRemediation: (constraint, building) => ({\n            type: 'VARIANCE_APPLICATION',\n            title: 'Apply for Zoning Variance',\n            description: `Your building fits the neighborhood context (${constraint.contextualLimit}m). Apply for a variance with MA 37.`,\n            action: null, // No automatic fix, needs manual application\n            impact: 'High approval probability due to context alignment',\n            icon: 'üìã'\n        })\n    },\n    SEISMIC_RISK: {\n        priority: 1,\n        getRemediation: (constraint, building) => ({\n            type: 'MATERIAL_CHANGE',\n            title: 'Switch to CLT Construction',\n            description: 'Cross-Laminated Timber reduces seismic stress due to lower mass and higher flexibility.',\n            action: { material: 'TIMBER' },\n            impact: '+15% Seismic score, carbon storage bonus',\n            icon: 'ü™µ'\n        })\n    },\n    WIND_LOAD_WARNING: {\n        priority: 2,\n        getRemediation: (constraint, building) => ({\n            type: 'FOOTPRINT_REDUCTION',\n            title: 'Reduce Upper Floor Footprint',\n            description: 'Step back the top 2-3 floors by 2m to reduce wind surface area.',\n            action: { setback: 2 },\n            impact: 'Reduces wind pressure coefficient',\n            icon: 'üí®'\n        })\n    },\n    SURFACE_SEAL_EXCEEDED: {\n        priority: 1,\n        getRemediation: (constraint, building) => ({\n            type: 'PERMEABLE_SURFACES',\n            title: 'Add Permeable Paving',\n            description: `Reduce sealed surface from ${constraint.actual}% to below 80% using permeable materials.`,\n            action: { surfaceSeal: 78 },\n            impact: 'Unblocks Climate compliance',\n            icon: 'üåø'\n        })\n    },\n    GREEN_ROOF: {\n        priority: 3,\n        getRemediation: (constraint, building) => ({\n            type: 'ADD_GREEN_ROOF',\n            title: 'Install Green Roof System',\n            description: 'Extensive green roof installation meeting Vienna minimum requirements.',\n            action: { hasGreenRoof: true },\n            impact: 'Satisfies Climate mandate',\n            icon: 'üå±'\n        })\n    },\n    SOLAR_INSTALLATION: {\n        priority: 3,\n        getRemediation: (constraint, building) => ({\n            type: 'ADD_SOLAR',\n            title: 'Install Solar Panels',\n            description: 'PV installation covering 20% of roof area per 2023 Building Code.',\n            action: { hasSolarPanels: true },\n            impact: 'Satisfies solar mandate',\n            icon: '‚òÄÔ∏è'\n        })\n    }\n};\n\n/**\n * Generate rule-based remediations from audit constraints\n */\nexport function generateRuleBasedRemediations(constraints, building) {\n    const remediations = [];\n    \n    for (const constraint of constraints) {\n        const rule = REMEDIATION_RULES[constraint.type];\n        if (rule) {\n            remediations.push({\n                ...rule.getRemediation(constraint, building),\n                constraintType: constraint.type,\n                severity: constraint.severity,\n                priority: rule.priority\n            });\n        }\n    }\n    \n    // Sort by priority (1 = most important)\n    return remediations.sort((a, b) => a.priority - b.priority);\n}\n\n/**\n * Generate AI-powered remediation suggestions for complex cases\n */\nexport async function generateAIRemediation(auditResults) {\n    if (!GEMINI_API_KEY) {\n        console.warn('Gemini API key not available for AI remediation');\n        return null;\n    }\n    \n    const { building, constraints, audits, feasibility } = auditResults;\n    \n    // Build the prompt with all violation details\n    const violationSummary = constraints\n        .filter(c => c.severity === 'critical' || c.severity === 'blocking')\n        .map(c => `- ${c.type}: ${c.message}`)\n        .join('\\n');\n    \n    const prompt = `You are a Vienna building regulation expert. A proposed building has failed compliance checks.\n\nBuilding Details:\n- Height: ${building.height}m\n- Material: ${building.material || 'CONCRETE'}\n- Floors: ${building.floors}\n- Location: District ${auditResults.district || 'Unknown'}\n- Current Feasibility: ${feasibility}%\n\nViolations:\n${violationSummary}\n\nAudit Scores:\n- Zoning: ${audits?.zoning?.score || 'N/A'}%\n- Seismic: ${audits?.seismic?.score || 'N/A'}%\n- Climate: ${audits?.climate?.score || 'N/A'}%\n\nProvide exactly 3 specific architectural remediation steps to improve compliance. For each step, provide:\n1. A clear action title\n2. A technical description\n3. The expected improvement\n\nFormat as JSON array:\n[\n  {\"title\": \"...\", \"description\": \"...\", \"impact\": \"...\"},\n  {\"title\": \"...\", \"description\": \"...\", \"impact\": \"...\"},\n  {\"title\": \"...\", \"description\": \"...\", \"impact\": \"...\"}\n]`;\n\n    try {\n        const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                contents: [{ parts: [{ text: prompt }] }],\n                generationConfig: { \n                    temperature: 0.4, \n                    maxOutputTokens: 512 \n                }\n            })\n        });\n        \n        if (!response.ok) {\n            throw new Error('Gemini API request failed');\n        }\n        \n        const data = await response.json();\n        const aiText = data.candidates?.[0]?.content?.parts?.[0]?.text;\n        \n        if (!aiText) {\n            return null;\n        }\n        \n        // Parse the JSON from AI response\n        const jsonMatch = aiText.match(/\\[[\\s\\S]*\\]/);\n        if (jsonMatch) {\n            const suggestions = JSON.parse(jsonMatch[0]);\n            return suggestions.map((s, idx) => ({\n                ...s,\n                type: 'AI_SUGGESTION',\n                icon: 'ü§ñ',\n                priority: idx + 1,\n                source: 'gemini'\n            }));\n        }\n        \n        return null;\n    } catch (error) {\n        console.error('AI Remediation failed:', error);\n        return null;\n    }\n}\n\n/**\n * Get combined remediation suggestions (rule-based + AI)\n */\nexport async function getRemediationSuggestions(auditResults) {\n    const { constraints, building } = auditResults;\n    \n    // Get rule-based remediations first (instant)\n    const ruleBasedRemediations = generateRuleBasedRemediations(constraints, building);\n    \n    // Get AI remediations (async)\n    const aiRemediations = await generateAIRemediation(auditResults);\n    \n    return {\n        ruleBased: ruleBasedRemediations,\n        aiSuggestions: aiRemediations || [],\n        combined: [\n            ...ruleBasedRemediations.slice(0, 3),\n            ...(aiRemediations || []).slice(0, 2)\n        ]\n    };\n}\n\nexport default {\n    generateRuleBasedRemediations,\n    generateAIRemediation,\n    getRemediationSuggestions\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/spatial.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/spatial_utils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/src/services/validator.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":233,"column":38,"nodeType":"Identifier","messageId":"undef","endLine":233,"endColumn":44},{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":234,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":234,"endColumn":11}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * ArchiShield Alpha V2 - Building Data Validator\n * ===============================================\n * Enhanced schema with location, lot info, and setback distances\n */\n\nconst BuildingValidator = {\n    // Required fields schema\n    schema: {\n        // Identity\n        name: { type: 'string', required: true, minLength: 1 },\n        \n        // Location (for data layer lookup)\n        latitude: { type: 'number', required: false, min: -90, max: 90, unit: '¬∞', default: 42.6977 },\n        longitude: { type: 'number', required: false, min: -180, max: 180, unit: '¬∞', default: 23.3219 },\n        \n        // Physical Parameters\n        height: { type: 'number', required: true, min: 1, max: 500, unit: 'meters' },\n        floors: { type: 'number', required: false, min: 1, max: 200, unit: 'count' },\n        footprint_area: { type: 'number', required: true, min: 10, max: 100000, unit: 'm¬≤' },\n        total_floor_area: { type: 'number', required: false, min: 10, max: 500000, unit: 'm¬≤' },\n        \n        // Lot Information (for zoning)\n        lot_area: { type: 'number', required: false, min: 50, max: 1000000, unit: 'm¬≤' },\n        property_line_north: { type: 'number', required: false, min: 0, max: 500, unit: 'meters' },\n        property_line_south: { type: 'number', required: false, min: 0, max: 500, unit: 'meters' },\n        property_line_east: { type: 'number', required: false, min: 0, max: 500, unit: 'meters' },\n        property_line_west: { type: 'number', required: false, min: 0, max: 500, unit: 'meters' },\n        \n        // Ground Floor Elevation\n        ground_floor_elevation: { type: 'number', required: false, min: -10, max: 50, unit: 'meters', default: 0 },\n        \n        // Structural\n        material_density: { type: 'number', required: true, min: 100, max: 10000, unit: 'kg/m¬≥' },\n        foundation_depth: { type: 'number', required: true, min: 0.5, max: 50, unit: 'meters' },\n        structural_system: { type: 'string', required: false, enum: ['moment_frame', 'shear_wall', 'braced_frame', 'dual_system', 'bearing_wall'] },\n        ground_floor_material: { type: 'string', required: true, enum: ['reinforced_concrete', 'steel_frame', 'brick', 'timber', 'aerated_concrete'] },\n        \n        // Envelope (with orientation)\n        window_to_wall_ratio: { type: 'number', required: true, min: 0, max: 1, unit: 'ratio' },\n        wwr_north: { type: 'number', required: false, min: 0, max: 1, unit: 'ratio' },\n        wwr_south: { type: 'number', required: false, min: 0, max: 1, unit: 'ratio' },\n        wwr_east: { type: 'number', required: false, min: 0, max: 1, unit: 'ratio' },\n        wwr_west: { type: 'number', required: false, min: 0, max: 1, unit: 'ratio' },\n        \n        // Thermal\n        thermal_mass: { type: 'number', required: true, min: 100, max: 5000, unit: 'J/kg¬∑K' },\n        insulation_r_value: { type: 'number', required: true, min: 0.1, max: 20, unit: 'm¬≤¬∑K/W' },\n        \n        // Energy\n        energy_autonomy_level: { type: 'number', required: true, min: 0, max: 100, unit: '%' },\n        has_backup_power: { type: 'boolean', required: false },\n        has_water_storage: { type: 'boolean', required: false },\n        \n        // Site Context\n        adjacent_to_red_zone: { type: 'boolean', required: false },\n        red_zone_direction: { type: 'string', required: false, enum: ['north', 'south', 'east', 'west', 'none'] },\n        site_elevation: { type: 'number', required: false, min: 0, max: 3000, unit: 'meters' },\n        flood_zone: { type: 'string', required: false, enum: ['Zone A', 'Zone AE', 'Zone X', 'Zone VE'] },\n        \n        // Roof\n        roof_type: { type: 'string', required: false, enum: ['flat', 'pitched', 'green', 'cool'] },\n        has_basement: { type: 'boolean', required: false },\n        \n        // Occupancy\n        occupancy: { type: 'number', required: false, min: 1, max: 50000, unit: 'persons' },\n        occupancy_type: { type: 'string', required: false, enum: ['residential', 'commercial', 'mixed', 'institutional'] }\n    },\n\n    /**\n     * Validate building data against schema\n     */\n    validate(building) {\n        const errors = [];\n        const warnings = [];\n        const sanitized = {};\n\n        if (!building || typeof building !== 'object') {\n            return {\n                valid: false,\n                errors: ['Building data must be a valid JSON object'],\n                warnings: [],\n                sanitized: null\n            };\n        }\n\n        // Validate each field\n        for (const [field, rules] of Object.entries(this.schema)) {\n            const value = building[field];\n\n            // Apply defaults for missing optional fields\n            if ((value === undefined || value === null) && rules.default !== undefined) {\n                sanitized[field] = rules.default;\n                continue;\n            }\n\n            // Check required fields\n            if (rules.required && (value === undefined || value === null || value === '')) {\n                errors.push(`Missing required field: ${field}`);\n                continue;\n            }\n\n            // Skip validation for optional empty fields\n            if (!rules.required && (value === undefined || value === null)) {\n                continue;\n            }\n\n            // Type validation\n            if (rules.type === 'number') {\n                const numValue = parseFloat(value);\n                if (isNaN(numValue)) {\n                    errors.push(`${field} must be a valid number`);\n                    continue;\n                }\n                if (rules.min !== undefined && numValue < rules.min) {\n                    errors.push(`${field} must be at least ${rules.min} ${rules.unit || ''}`);\n                    continue;\n                }\n                if (rules.max !== undefined && numValue > rules.max) {\n                    errors.push(`${field} must not exceed ${rules.max} ${rules.unit || ''}`);\n                    continue;\n                }\n                sanitized[field] = numValue;\n            } else if (rules.type === 'string') {\n                if (typeof value !== 'string') {\n                    errors.push(`${field} must be a string`);\n                    continue;\n                }\n                const normalizedValue = value.toLowerCase().trim();\n                if (rules.minLength && normalizedValue.length < rules.minLength) {\n                    errors.push(`${field} must have at least ${rules.minLength} characters`);\n                    continue;\n                }\n                if (rules.enum && !rules.enum.includes(normalizedValue)) {\n                    errors.push(`${field} must be one of: ${rules.enum.join(', ')}`);\n                    continue;\n                }\n                sanitized[field] = rules.enum ? normalizedValue : value.trim();\n            } else if (rules.type === 'boolean') {\n                sanitized[field] = Boolean(value);\n            }\n        }\n\n        // Calculate derived properties\n        if (sanitized.footprint_area && sanitized.height) {\n            sanitized.floors = sanitized.floors || Math.ceil(sanitized.height / 3.5);\n            sanitized.volume = sanitized.footprint_area * sanitized.height;\n            sanitized.footprintWidth = Math.sqrt(sanitized.footprint_area);\n            sanitized.surfaceArea = 2 * sanitized.footprint_area + 4 * sanitized.footprintWidth * sanitized.height;\n            sanitized.wallArea = 4 * sanitized.footprintWidth * sanitized.height;\n            sanitized.windowArea = sanitized.wallArea * (sanitized.window_to_wall_ratio || 0);\n            \n            // Calculate total floor area if not provided\n            sanitized.total_floor_area = sanitized.total_floor_area || \n                (sanitized.footprint_area * sanitized.floors);\n        }\n\n        // Default lot area to 2x footprint if not provided\n        if (!sanitized.lot_area && sanitized.footprint_area) {\n            sanitized.lot_area = sanitized.footprint_area * 2;\n            warnings.push('Lot area not provided, defaulting to 2√ó footprint area');\n        }\n\n        // Calculate FAR\n        if (sanitized.total_floor_area && sanitized.lot_area) {\n            sanitized.actualFAR = sanitized.total_floor_area / sanitized.lot_area;\n        }\n\n        // Default property line distances if not provided\n        const defaultSetback = sanitized.height ? sanitized.height * 0.3 : 10;\n        sanitized.property_line_north = sanitized.property_line_north ?? defaultSetback;\n        sanitized.property_line_south = sanitized.property_line_south ?? defaultSetback;\n        sanitized.property_line_east = sanitized.property_line_east ?? defaultSetback;\n        sanitized.property_line_west = sanitized.property_line_west ?? defaultSetback;\n\n        // WWR by orientation defaults\n        if (sanitized.window_to_wall_ratio) {\n            sanitized.wwr_north = sanitized.wwr_north ?? sanitized.window_to_wall_ratio;\n            sanitized.wwr_south = sanitized.wwr_south ?? sanitized.window_to_wall_ratio;\n            sanitized.wwr_east = sanitized.wwr_east ?? sanitized.window_to_wall_ratio;\n            sanitized.wwr_west = sanitized.wwr_west ?? sanitized.window_to_wall_ratio;\n        }\n\n        // Other defaults\n        sanitized.latitude = sanitized.latitude ?? 42.6977;\n        sanitized.longitude = sanitized.longitude ?? 23.3219;\n        sanitized.ground_floor_elevation = sanitized.ground_floor_elevation ?? 0;\n        sanitized.has_basement = sanitized.has_basement ?? false;\n        sanitized.has_backup_power = sanitized.has_backup_power ?? (sanitized.energy_autonomy_level >= 50);\n        sanitized.has_water_storage = sanitized.has_water_storage ?? false;\n        sanitized.adjacent_to_red_zone = sanitized.adjacent_to_red_zone ?? true;\n        sanitized.red_zone_direction = sanitized.red_zone_direction ?? 'south';\n        sanitized.site_elevation = sanitized.site_elevation ?? 550;\n        sanitized.structural_system = sanitized.structural_system ?? 'moment_frame';\n        sanitized.roof_type = sanitized.roof_type ?? 'flat';\n        sanitized.flood_zone = sanitized.flood_zone ?? 'Zone AE';\n        sanitized.occupancy_type = sanitized.occupancy_type ?? 'mixed';\n        sanitized.initialInternalTemp = 24;\n\n        // Generate warnings for suboptimal configurations\n        if (sanitized.foundation_depth < 4) {\n            warnings.push(`Foundation depth ${sanitized.foundation_depth}m below 4m may fail hydraulic audit`);\n        }\n        if (sanitized.window_to_wall_ratio > 0.4) {\n            warnings.push(`High WWR ${(sanitized.window_to_wall_ratio * 100).toFixed(0)}% may exceed orientation limits`);\n        }\n        if (sanitized.actualFAR > 3.5) {\n            warnings.push(`FAR ${sanitized.actualFAR.toFixed(2)} exceeds Sofia limit of 3.5`);\n        }\n\n        return {\n            valid: errors.length === 0,\n            errors,\n            warnings,\n            sanitized: errors.length === 0 ? sanitized : null\n        };\n    },\n\n    /**\n     * Parse JSON string to building object\n     */\n    parseJSON(jsonString) {\n        try {\n            const parsed = JSON.parse(jsonString);\n            return { success: true, data: parsed };\n        } catch (e) {\n            return { success: false, error: `Invalid JSON: ${e.message}` };\n        }\n    }\n};\n\n// Export for module systems\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = BuildingValidator;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/serafimkrastev/Desktop/Learnings/webDev/UNI/archishield-react/vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
